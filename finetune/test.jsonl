{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "# module_a.py\nfrom module_b import ClassB\n\nclass ClassA:\n    def use(self): ClassB()", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Circular Import\", \"message\": \"Mutual imports create coupling and runtime errors\", \"suggestion\": \"Refactor to shared module or use lazy imports\"}"}
{"instruction": "Analyze this Python code for architectural quality. Return strict JSON.", "input": "import RPi.GPIO as GPIO\nimport os\nimport time\nimport datetime\nimport glob\nimport MySQLdb\nfrom time import strftime\nimport serial\n\nser = serial.Serial(\n    port='/dev/ttyACM0',\n    baudrate = 9600,\n    parity=serial.PARITY_NONE,\n    stopbits=serial.STOPBITS_ONE,\n    bytesize=serial.EIGHTBITS,\n    timeout=1\n)\n\ncounter = 0\n\nGPIO.setmode(GPIO.BOARD)\nGPIO.setup(15,GPIO.IN)\n# Variables for MySQL\ndb = MySQLdb.connect(host=\"localhost\", user=\"root\",passwd=\"deb280794\", db=\"temp_database\")\ncur = db.cursor()\n\nwhile True:  \n    x = ser.readline()\n    f=x.split()\n    moisture = f[1]\n    humidity = f[4]\n    temp = f[7]\n    print(\"Moisture: \")\n    print moisture\n    print(\"Humidity: \")\n    print humidity\n    print(\"Temperature: \")\n    print temp\n    datetimeWrite = (time.strftime(\"%Y-%m-%d \") + time.strftime(\"%H:%M:%S\"))\n    sql = (\"\"\"INSERT INTO tempLog (datetime,temperature,humidity,moisture) VALUES (%s,%s,%s,%s)\"\"\",(datetimeWrite,temp,humidity,moisture))\n    try:\n        print \"Writing to database...\"\n        # Execute the SQL command\n        cur.execute(*sql)\n        # Commit your changes in the database\n        db.commit()\n        print \"Write Complete\"\n    except:\n        # Rollback in case there is any error\n        db.rollback()\n        print \"Failed writing to database\"\n\n    time.sleep(0.5)", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Hardcoded secret detected\", \"suggestion\": \"Move secrets to environment variables or a secrets manager (vault/KMS), and rotate exposed keys.\", \"extra\": {\"signals\": [\"security\"], \"evidence\": [\"db = MySQLdb.connect(host=\\\"localhost\\\", user=\\\"root\\\",passwd=\\\"deb280794\\\", db=\\\"temp_database\\\")\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"Shashank95/Intellifarm\", \"path\": \"logdata.py\"}}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "API_KEY = \"sk-1234567890abcdef\"\nheaders = {\"Authorization\": f\"Bearer {API_KEY}\"}", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Hardcoded Credentials\", \"message\": \"API keys in source code leak in VCS\", \"suggestion\": \"Use os.getenv(\\\"API_KEY\\\") or secret managers\"}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "import { Component, OnInit, Input, EventEmitter, Output } from '@angular/core';\nimport { Filter, FilterType } from 'lib/filter';\n\n@Component({\n  selector: 'iw-filter-input',\n  templateUrl: './filter-input.component.html',\n  styleUrls: ['./filter-input.component.css']\n})\nexport class FilterInputComponent implements OnInit {\n  @Input() filter: Filter;\n  @Output() change = new EventEmitter<Filter>();\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n  get FilterType() {\n    return FilterType;\n  }\n\n  applyFilter(filter: Filter, value: string) {\n    filter.value = value;\n    this.change.emit(filter);\n  }\n\n\n  itemsForField(filter: Filter) {\n    if (filter.options) {\n      return filter.options;\n    }\n    // put to initialization\n    // if (!this.rows) { return []; }\n    // const items = [];\n    // this.rows.forEach((r) => {\n    //   if (items.indexOf(r[filter.key]) < 0) {\n    //     items.push(r[filter.key]);\n    //   }\n    // });\n    // return items;\n  }\n}\n\n/*\n\n  filterData(key: string, value: any) {\n    let filter: Filter = this.filters\n      .find((f) => f.key === key);\n    if (!filter) {\n      filter = {\n        type: FilterType.String, key, value\n      };\n      this.filters.push(filter);\n    } else {\n      // overwritte previous value\n      filter.value = value;\n    }\n    this.filterChange.emit();\n  }\n}\n\n*/", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Type safety weakened by 'any'\", \"suggestion\": \"Replace 'any' with specific interfaces/types or 'unknown' + narrowing.\", \"extra\": {\"signals\": [\"type-safety\"], \"evidence\": [\"filterData(key: string, value: any) {\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"zorec/ng2-pack\", \"path\": \"src/app/filter-input/filter-input.component.ts\"}}"}
{"instruction": "Analyze this Javascript code for security vulnerabilities. Return strict JSON.", "input": "indexFiles.map(indexFile => {\n        return path.join(modulesPath, moduleName, prefix, importPath, indexFile) + extension;\n      }),\n    ),\n  );\n\n  return flattenDeep(paths).find(p => fs.existsSync(p));\n}\n\nfunction _getAllSpinnakerPackages(modulesPath) {\n  const paths = fs.readdirSync(modulesPath);\n  return paths\n    .map(file => path.join(modulesPath, file))\n    .filter(child => fs.statSync(child).isDirectory())\n    .map(packagePath => packagePath.split('/').pop());\n}\n\nconst getAllSpinnakerPackages = memoize(_getAllSpinnakerPackages);\n\nfunction makeResult(pkg, importPath) {", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-22)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-22\"], \"cwe\": \"CWE-22\", \"rule\": \"The application dynamically constructs file or path information. If the path\\ninformation comes from user-supplied input, it could be abused to read sensitive files,\\naccess other users' data, or aid in exploitation to gain further system access.\\n\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "import {WidgetConfig} from '../shared/widget-config';\nimport {WidgetService} from '../shared/widget.service';\n\nexport class Widget {\n\n  title: string;\n  updateInterval: number = 1000;\n  widgetConfig: WidgetConfig;\n  titleUrl: string;\n  description: string;\n\n  constructor(private widgetService: WidgetService) {\n  }\n\n  getTitle(): string {\n    return this.title;\n  }\n\n  initWidget(widgetConfig: WidgetConfig) {\n    this.widgetConfig = widgetConfig;\n    this.title = widgetConfig.title;\n    this.titleUrl = widgetConfig.titleUrl;\n    this.description = widgetConfig.description;\n    this.triggerUpdate();\n  }\n\n  triggerUpdate() {\n    setInterval(() => {\n      this.updateWidgetData();\n    }, this.updateInterval);\n  }\n\n  updateWidgetData() {\n    this.widgetService.getWidgetData(this.widgetConfig).subscribe(\n      widgetData => {\n        if (widgetData.length > 0) {\n          this.updateData(widgetData);\n        }\n      },\n      error => console.error(error)\n    );\n  }\n\n  updateData(data: any) {\n    // log backend errors\n    for (const sourceData of data) {\n      if ((sourceData.data || {}).errors) {\n        sourceData.data.errors.forEach(error => console.error(error));\n      }\n    }\n\n    // custom logic is implemented by widgets\n  }\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Type safety weakened by 'any'\", \"suggestion\": \"Replace 'any' with specific interfaces/types or 'unknown' + narrowing.\", \"extra\": {\"signals\": [\"type-safety\"], \"evidence\": [\"updateData(data: any) {\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"reflectoring/infiniboard\", \"path\": \"dashy/src/app/dashboard/widget/widget.ts\"}}"}
{"instruction": "Analyze this Javascript code for security vulnerabilities. Return strict JSON.", "input": "test.ok(fs.existsSync(path.join('build', 'views', 'suppliernew.erb')));\r\n        test.ok(fs.existsSync(path.join('build', 'views', 'supplierview.erb')));\r\n        test.ok(fs.existsSync(path.join('build', 'views', 'supplieredit.erb')));\r\n\r\n        test.ok(fs.existsSync(path.join('build', 'entities')));\r\n        test.ok(fs.existsSync(path.join('build', 'entities', 'customer.rb')));\r\n        test.ok(fs.existsSync(path.join('build', 'entities', 'supplier.rb')));\r\n        test.ok(fs.existsSync(path.join('build', 'entities', 'department.rb')));\r\n        test.ok(fs.existsSync(path.join('build', 'entities', 'employee.rb')));\r\n\r\n        test.ok(fs.existsSync(path.join('build', 'controllers')));\r\n        test.ok(fs.existsSync(path.join('build', 'controllers', 'customer.rb')));\r\n        test.ok(fs.existsSync(path.join('build', 'controllers', 'supplier.rb')));\r\n        test.ok(fs.existsSync(path.join('build', 'controllers', 'department.rb')));\r\n        test.ok(fs.existsSync(path.join('build', 'controllers', 'employee.rb')));\r\n        \r\n        process.chdir(cwd);\r\n        \r\n        test.done();\r\n    });", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-22)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-22\"], \"cwe\": \"CWE-22\", \"rule\": \"The application dynamically constructs file or path information. If the path\\ninformation comes from user-supplied input, it could be abused to read sensitive files,\\naccess other users' data, or aid in exploitation to gain further system access.\\n\"}}"}
{"instruction": "Analyze this Python code for security vulnerabilities. Return strict JSON.", "input": "print 'copy large file fail because head object fail, status:%s' %(res.status)\n        sys.exit(-1)\n    content_len = (int)(res.getheader('Content-Length'))\n    etag = res.getheader('ETag')\n    #get part size\n    default_part_size = 10 * 1024 * 1024\n    part_size = default_part_size\n    max_part_num=10000\n    min_part_size = 5 * 1024 * 1024 \n    if options.part_size:\n        part_size = (int)(eval(options.part_size))\n    if part_size < min_part_size:\n        print 'part size too small, change part size to %s' %(default_part_size)\n        part_size = default_part_size\n    if part_size * max_part_num < content_len:\n        part_size = (content_len + max_part_num - content_len % max_part_num) / max_part_num\n        print 'part num more than max part num %s, change part size to %s' %(max_part_num, part_size)\n\n    if content_len % part_size:\n        part_size_list = [part_size] * (content_len / part_size) + [ content_len % part_size]", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-94)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-94\"], \"cwe\": \"CWE-94\", \"rule\": \"Potential code injection due to eval usage.\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "import { useCallback, useState, useEffect } from 'react';\nimport { KeyStore } from './keystore';\nimport type { Accounts, Hooks as HooksType } from './../types';\n\nexport const Hooks = {\n  useKeyStore: () => {\n    const [accounts, setAccounts] = useState<Accounts>();\n    const [error, setError] = useState<string>();\n    useEffect(() => {\n      async function getAccounts() {\n        try {\n          setAccounts(await KeyStore.getAccounts());\n        } catch (err: any) {\n          setError(err);\n        }\n      }\n      getAccounts();\n    }, []);\n    const newAccount = useCallback((passphrase: string) => {\n      async function addAccount() {\n        try {\n          await KeyStore.newAccount(passphrase);\n          setAccounts(await KeyStore.getAccounts());\n        } catch (err: any) {\n          setError(err);\n        }\n      }\n      addAccount();\n    }, []);\n    return { accounts, error, newAccount };\n  },\n  useEthereumClient: () => {},\n} as HooksType;", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Type safety weakened by 'any'\", \"suggestion\": \"Replace 'any' with specific interfaces/types or 'unknown' + narrowing.\", \"extra\": {\"signals\": [\"type-safety\"], \"evidence\": [\"} catch (err: any) {\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"YsnKsy/react-native-geth\", \"path\": \"src/packages/hooks.tsx\"}}"}
{"instruction": "Analyze this Java code for security vulnerabilities. Return strict JSON.", "input": "FST<T> doTest(int prune1, int prune2, boolean allowRandomSuffixSharing) throws IOException {\n    if (LuceneTestCase.VERBOSE) {\n      System.out.println(\"\\nTEST: prune1=\" + prune1 + \" prune2=\" + prune2);\n    }\n\n    final boolean willRewrite = random.nextBoolean();\n\n    final Builder<T> builder = new Builder<T>(inputMode == 0 ? FST.INPUT_TYPE.BYTE1 : FST.INPUT_TYPE.BYTE4,\n                                              prune1, prune2,\n                                              prune1==0 && prune2==0,\n                                              allowRandomSuffixSharing ? random.nextBoolean() : true,\n                                              allowRandomSuffixSharing ? _TestUtil.nextInt(random, 1, 10) : Integer.MAX_VALUE,\n                                              outputs,\n                                              null,\n                                              willRewrite,\n                                              PackedInts.DEFAULT,\n                                              true,\n                                              15);\n    if (LuceneTestCase.VERBOSE) {\n      if (willRewrite) {", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-330)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-330\"], \"cwe\": \"CWE-330\", \"rule\": \"Depending on the context, generating weak random numbers may expose cryptographic functions\\nwhich rely on these numbers, to be exploitable. When generating numbers for sensitive values\\nsuch as tokens, nonces, and cryptographic keys, it is recommended that the `DRBG` instance\\nof `SecureRandom` be used.\\n\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "/// <reference types=\"chai\" />\n\ndeclare module \"chai-bytes\" {\n    function chaiBytes(chai: any, utils: any): void;\n    \n    export = chaiBytes;\n}\n\ndeclare namespace Chai {\n\n    // For BDD API\n    interface Assertion extends LanguageChains, NumericComparison, TypeComparison {\n        equalBytes(expected: string | Array<number> | ArrayLike<number>): void;\n    }\n\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Type safety weakened by 'any'\", \"suggestion\": \"Replace 'any' with specific interfaces/types or 'unknown' + narrowing.\", \"extra\": {\"signals\": [\"type-safety\"], \"evidence\": [\"function chaiBytes(chai: any, utils: any): void;\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"MiSchroe/klf-200-api\", \"path\": \"types/chai-bytes/index.d.ts\"}}"}
{"instruction": "Analyze this Java code for architectural quality. Return strict JSON.", "input": "/*\n * Author: Minho Kim (ISKU)\n * Date: March 3, 2018\n * E-mail: minho.kim093@gmail.com\n *\n * https://github.com/ISKU/Algorithm\n * https://www.acmicpc.net/problem/13169\n */\n\nimport java.util.*;\n\npublic class Main {\n\n\tprivate static long[] array;\n\tprivate static int N;\n\n\tpublic static void main(String... args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tN = sc.nextInt();\n\n\t\tarray = new long[N];\n\t\tfor (int i = 0; i < N; i++)\n\t\t\tarray[i] = sc.nextInt();\n\n\t\tSystem.out.print(sum(0, 0));\n\t}\n\n\tprivate static long sum(int i, long value) {\n\t\tif (i == N)\n\t\t\treturn value;\n\t\treturn sum(i + 1, value + array[i]) ^ sum(i + 1, value);\n\t}\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Use of System.out for logging\", \"suggestion\": \"Use a structured logger (e.g., SLF4J) and consistent log levels; avoid stdout in production.\", \"extra\": {\"signals\": [\"observability\"], \"evidence\": [\"System.out.print(sum(0, 0));\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"ISKU/Algorithm\", \"path\": \"BOJ/13169/Main.java\"}}"}
{"instruction": "Analyze this Javascript code for security vulnerabilities. Return strict JSON.", "input": "function onMouseUp(event){\n    ismousedown = false;\n    console.log(\"onMouseUp\");\n}\n\nfunction onMouseDown(event){\n    ismousedown = true;\n    console.log(\"onMouseDown\");\n    nsteps = 20 + Math.random()*160;\n}\nvar nsteps = 20;\n\nfunction drawParticleUpdate()\n{\n    if(ismousedown)\n    {\n        var n = 50;\n        var nx = mousex/w +  Math.random()*0.02 ;", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-338)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-338\"], \"cwe\": \"CWE-338\", \"rule\": \"\\\\bMath\\\\.random\"}}"}
{"instruction": "Analyze this Python code for architectural quality. Return strict JSON.", "input": "import sys\n\nimport pytest\n\nfrom opentracing.ext import tags\nfrom sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker\n\nfrom opentracing_instrumentation.client_hooks import mysqldb as mysqldb_hooks\nfrom opentracing_instrumentation.request_context import span_in_context\nfrom .sql_common import metadata, User\n\n\nSKIP_REASON_PYTHON_3 = 'MySQLdb is not compatible with Python 3'\nSKIP_REASON_CONNECTION = 'MySQL is not running or cannot connect'\nMYSQL_CONNECTION_STRING = 'mysql://root@127.0.0.1/test'\n\n\n@pytest.fixture\ndef session():\n    Session = sessionmaker()\n    engine = create_engine(MYSQL_CONNECTION_STRING)\n    Session.configure(bind=engine)\n    metadata.create_all(engine)\n    try:\n        yield Session()\n    except:\n        pass\n\n\n@pytest.fixture(autouse=True, scope='module')\ndef patch_sqlalchemy():\n    mysqldb_hooks.install_patches()\n    try:\n        yield\n    finally:\n        mysqldb_hooks.reset_patches()\n\n\ndef is_mysql_running():\n    try:\n        import MySQLdb\n        with MySQLdb.connect(host='127.0.0.1', user='root'):\n            pass\n        return True\n    except:\n        return False\n\n\ndef assert_span(span, operation, parent=None):\n    assert span.operation_name == 'MySQLdb:' + operation\n    assert span.tags.get(tags.SPAN_KIND) == tags.SPAN_KIND_RPC_CLIENT\n    if parent:\n        assert span.parent_id == parent.context.span_id\n        assert span.context.trace_id == parent.context.trace_id\n    else:\n        assert span.parent_id is None\n\n\n@pytest.mark.skipif(not is_mysql_running(), reason=SKIP_REASON_CONNECTION)\n@pytest.mark.skipif(sys.version_info.major == 3, reason=SKIP_REASON_PYTHON_3)\ndef test_db(tracer, session):\n    root_span = tracer.start_span('root-span')\n\n    # span recording works for regular operations within a context only\n    with span_in_context(root_span):\n        user = User(name='user', fullname='User', password='password')\n        session.add(user)\n        session.commit()\n\n    spans = tracer.recorder.get_spans()\n    assert len(spans) == 4\n\n    connect_span, insert_span, commit_span, rollback_span = spans\n    assert_span(connect_span, 'Connect')\n    assert_span(insert_span, 'INSERT', root_span)\n    assert_span(commit_span, 'commit', root_span)\n    assert_span(rollback_span, 'rollback', root_span)", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Bare 'except:' block; Bare 'except:' block\", \"suggestion\": \"Catch specific exceptions and handle/log them appropriately; avoid swallowing unknown errors. Catch specific exceptions and handle/log them appropriately; avoid swallowing unknown errors.\", \"extra\": {\"signals\": [\"error-handling\", \"error-handling\"], \"evidence\": [\"@L27: except:\", \"@L46: except:\"], \"confidence\": \"high\", \"license\": \"mit\", \"repo\": \"uber-common/opentracing-python-instrumentation\", \"path\": \"tests/opentracing_instrumentation/test_mysqldb.py\"}}"}
{"instruction": "Analyze this Java code for security vulnerabilities. Return strict JSON.", "input": "case OBJECT:\n            json.startObject(\"person2\");\n            json.field(\"first_name\", \"my_first_name_\" + i);\n            json.field(\"last_name\", \"my_last_name_\" + i);\n            json.field(\"ssn\", 1234 + i);\n            json.endObject();\n            break;\n          case GEO_POINT:\n            json.startObject(\"geo_location_1\");\n            json.field(\"lat\", Math.acos(random.nextDouble() * 2 - 1));\n            json.field(\"lon\", random.nextDouble() * Math.PI * 2);\n            json.endObject();\n            break;\n          case GEO_SHAPE:\n            // XXX - Implement\n            break;\n          default:\n            break;\n        }\n      }", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-330)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-330\"], \"cwe\": \"CWE-330\", \"rule\": \"Depending on the context, generating weak random numbers may expose cryptographic functions\\nwhich rely on these numbers, to be exploitable. When generating numbers for sensitive values\\nsuch as tokens, nonces, and cryptographic keys, it is recommended that the `DRBG` instance\\nof `SecureRandom` be used.\\n\"}}"}
{"instruction": "Analyze this Javascript code for security vulnerabilities. Return strict JSON.", "input": "})\n  })\n\n  if (opts.finish) extract.on('finish', opts.finish)\n\n  return extract\n}\n\nfunction validate (fs, name, root, cb) {\n  if (name === root) return cb(null, true)\n  fs.lstat(name, function (err, st) {\n    if (err && err.code !== 'ENOENT') return cb(err)\n    if (err || st.isDirectory()) return validate(fs, path.join(name, '..'), root, cb)\n    cb(null, false)\n  })\n}\n\nfunction mkdirfix (name, opts, cb) {\n  mkdirp(name, {fs: opts.fs}, function (err, made) {\n    if (!err && made && opts.own) {", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-22)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-22\"], \"cwe\": \"CWE-22\", \"rule\": \"The application dynamically constructs file or path information. If the path\\ninformation comes from user-supplied input, it could be abused to read sensitive files,\\naccess other users' data, or aid in exploitation to gain further system access.\\n\"}}"}
{"instruction": "Analyze this Javascript code for security vulnerabilities. Return strict JSON.", "input": "regex = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                        if (value && !regex.test(value)) {\n                            isValid = false;\n                            _addFieldError(field);\n                        }\n                        break;\n                }\n\n                var regexStr = field.attr('data-regex');\n                if (regexStr) {\n                    regex = new RegExp(regexStr);\n                    if (value && !regex.test(value)) {\n                        isValid = false;\n                        _addFieldError(field);\n                    }\n                }\n\n            });\n\n            if (!isValid) {", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-185)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-185\"], \"cwe\": \"CWE-185\", \"rule\": \"The `RegExp` constructor was called with a non-literal value. If an adversary were able to\\nsupply a malicious regex, they could cause a Regular Expression Denial of Service (ReDoS)\\nagainst the application. In Node applications, this could cause the entire application to no\\nlonger\\nbe responsive to other users' requests.\\n\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "/* tslint:disable:no-unused-variable */\nimport { async, ComponentFixture, TestBed } from '@angular/core/testing';\nimport { By } from '@angular/platform-browser';\nimport { DebugElement } from '@angular/core';\n\nimport { SettingsComponent } from './settings.component';\n\ndescribe('HomeComponent', () => {\n  let component: SettingsComponent;\n  let fixture: ComponentFixture<SettingsComponent>;\n\n  beforeEach(async(() => {\n    TestBed.configureTestingModule({\n      declarations: [ SettingsComponent ]\n    })\n    .compileComponents();\n  }));\n\n  beforeEach(() => {\n    fixture = TestBed.createComponent(SettingsComponent);\n    component = fixture.componentInstance;\n    fixture.detectChanges();\n  });\n\n  it('should create', () => {\n    expect(component).toBeTruthy();\n  });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Excessive callback/promise chaining\", \"suggestion\": \"Refactor to async/await, extract helper functions, and centralize error handling.\", \"extra\": {\"signals\": [\"readability\"], \"evidence\": [\".then count=0, close-brace-paren count=5\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"radiium/turntable\", \"path\": \"src/app/settings-panel/settings/settings.component.spec.ts\"}}"}
{"instruction": "Analyze this Javascript code for security vulnerabilities. Return strict JSON.", "input": "var smileyReplacer = function (smiley, replacement, line) {\n            // four possibilities: at the beginning, at the end, in the\n            // middle or only the smiley\n            var startSmiley = \"^\" + escapeRegExp(smiley) + \" \";\n            var endSmiley = \" \" + escapeRegExp(smiley) + \"$\";\n            var middleSmiley = \" \" + escapeRegExp(smiley) + \" \";\n            var onlySmiley = \"^\" + escapeRegExp(smiley) + \"$\";\n\n            return line.\n                replace(new RegExp(startSmiley), replacement + \" \").\n                replace(new RegExp(endSmiley), \" \" + replacement).\n                replace(new RegExp(middleSmiley), \" \" + replacement + \" \").\n                replace(new RegExp(onlySmiley), replacement);\n        };\n\n        // loop over smilies and replace them in the text\n        for (var i=0; i<smileyKeys.length; i++) {\n            var smiley = smileyKeys[i];\n            var replacement = '<img alt=\"' + smiley + '\" src=\"' +", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-185)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-185\"], \"cwe\": \"CWE-185\", \"rule\": \"The `RegExp` constructor was called with a non-literal value. If an adversary were able to\\nsupply a malicious regex, they could cause a Regular Expression Denial of Service (ReDoS)\\nagainst the application. In Node applications, this could cause the entire application to no\\nlonger\\nbe responsive to other users' requests.\\n\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport { async, ComponentFixture, TestBed } from '@angular/core/testing';\n\nimport { Comp624Component } from './comp-624.component';\n\ndescribe('Comp624Component', () => {\n  let component: Comp624Component;\n  let fixture: ComponentFixture<Comp624Component>;\n\n  beforeEach(async(() => {\n    TestBed.configureTestingModule({\n      declarations: [ Comp624Component ]\n    })\n    .compileComponents();\n  }));\n\n  beforeEach(() => {\n    fixture = TestBed.createComponent(Comp624Component);\n    component = fixture.componentInstance;\n    fixture.detectChanges();\n  });\n\n  it('should create', () => {\n    expect(component).toBeTruthy();\n  });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Excessive callback/promise chaining\", \"suggestion\": \"Refactor to async/await, extract helper functions, and centralize error handling.\", \"extra\": {\"signals\": [\"readability\"], \"evidence\": [\".then count=0, close-brace-paren count=5\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"angular/angular-cli-stress-test\", \"path\": \"src/app/components/comp-624/comp-624.component.spec.ts\"}}"}
{"instruction": "Analyze this Python code for architectural quality. Return strict JSON.", "input": "from Robinhood import Robinhood\n\n#Setup\nmy_trader = Robinhood(username=\"YOUR_USERNAME\", password=\"YOUR_PASSWORD\");\n\n#Get stock information\n    #Note: Sometimes more than one instrument may be returned for a given stock symbol\nstock_instrument = my_trader.instruments(\"GEVO\")[0]\n\n#Get a stock's quote\nmy_trader.print_quote(\"AAPL\")\n\n#Prompt for a symbol\nmy_trader.print_quote();\n\n#Print multiple symbols\nmy_trader.print_quotes(stocks=[\"BBRY\", \"FB\", \"MSFT\"])\n\n#View all data for a given stock ie. Ask price and size, bid price and size, previous close, adjusted previous close, etc.\nquote_info = my_trader.quote_data(\"GEVO\")\nprint(quote_info);\n\n#Place a buy order (uses market bid price)\nbuy_order = my_trader.place_buy_order(stock_instrument, 1)\n\n#Place a sell order\nsell_order = my_trader.place_sell_order(stock_instrument, 1)", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Hardcoded secret detected\", \"suggestion\": \"Move secrets to environment variables or a secrets manager (vault/KMS), and rotate exposed keys.\", \"extra\": {\"signals\": [\"security\"], \"evidence\": [\"my_trader = Robinhood(username=\\\"YOUR_USERNAME\\\", password=\\\"YOUR_PASSWORD\\\");\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"itsff/Robinhood\", \"path\": \"example.py\"}}"}
{"instruction": "Analyze this Javascript code for architectural quality. Return strict JSON.", "input": "/* Copyright (C) 2011-2014 Mattias Ekendahl. Used under MIT license, see full details at https://github.com/developedbyme/dbm/blob/master/LICENSE.txt */\ndbm.registerClass(\"dbm.thirdparty.facebook.constants.EventTypes\", null, function(objectFunctions, staticFunctions, ClassReference) {\n\t//console.log(\"dbm.thirdparty.facebook.constants.EventTypes\");\n\t\n\t//REFERENCE: http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/\n\t\n\tvar EventTypes = dbm.importClass(\"dbm.thirdparty.facebook.constants.EventTypes\");\n\t\n\tstaticFunctions.AUTH_LOGIN = \"auth.login\";\n\tstaticFunctions.AUTH_RESPONSE_CHANGE = \"auth.authResponseChange\";\n\tstaticFunctions.AUTH_STATUS_CHANGE = \"auth.statusChange\";\n\tstaticFunctions.AUTH_LOGOUT = \"auth.logout\";\n\tstaticFunctions.AUTH_PROMPT = \"auth.prompt\";\n\tstaticFunctions.XFBML_RENDER = \"xfbml.render\";\n\tstaticFunctions.EDGE_CREATE = \"edge.create\";\n\tstaticFunctions.EDGE_REMOVE = \"edge.remove\";\n\tstaticFunctions.COMMENT_CREATE = \"comment.create\";\n\tstaticFunctions.COMMENT_REMOVE = \"comment.remove\";\n\tstaticFunctions.MESSAGE_SEND = \"message.send\";\n\t\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Legacy 'var' usage\", \"suggestion\": \"Prefer 'const' by default; use 'let' when reassignment is needed.\", \"extra\": {\"signals\": [\"modern-standards\"], \"evidence\": [\"var EventTypes = dbm.importClass(\\\"dbm.thirdparty.facebook.constants.EventTypes\\\");\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"developedbyme/dbm\", \"path\": \"javascripts/dbm/classes/dbm/thirdparty/facebook/constants/EventTypes.js\"}}"}
{"instruction": "Analyze this Javascript code for architectural quality. Return strict JSON.", "input": "var fs = require('fs'),\n\tcons = require('consolidate'),\n\tdust = require('dustjs-linkedin');\n\n\nvar pages = [\n\t'index',\n\t'contact',\n\t'faq',\n\t'registration',\n\t'sponsors',\n\t'travel',\n\t'visit',\n\t'volunteers'\n];\n\npages.forEach(function(page) {\n\n\tcons.dust('views/'+page+'.dust', { views: __dirname+'/views'}, function(err, html) {\n\t\tif(err) return console.log('error: ', err);\n\n\t\tfs.writeFile(__dirname+'/dist/'+page+'.html', html, function(err) {\n\t\t\tif(err) return console.log('error saving file: ', page, err);\n\n\t\t\tconsole.log('create page: ', page);\n\t\t});\n\t});\n\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Legacy 'var' usage\", \"suggestion\": \"Prefer 'const' by default; use 'let' when reassignment is needed.\", \"extra\": {\"signals\": [\"modern-standards\"], \"evidence\": [\"var fs = require('fs'),\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"selfcontained/mini-cassia-turkey-trot\", \"path\": \"generate.js\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "import * as React from 'react';\n\nexport interface LabelDetailProps {\n  [key: string]: any;\n\n  /** An element type to render as (string or function). */\n  as?: any;\n\n  /** Primary content. */\n  children?: React.ReactNode;\n\n  /** Additional classes. */\n  className?: string;\n\n  /** Shorthand for primary content. */\n  content?: React.ReactNode;\n}\n\ndeclare const LabelDetail: React.StatelessComponent<LabelDetailProps>;\n\nexport default LabelDetail;", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Type safety weakened by 'any'\", \"suggestion\": \"Replace 'any' with specific interfaces/types or 'unknown' + narrowing.\", \"extra\": {\"signals\": [\"type-safety\"], \"evidence\": [\"[key: string]: any;\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"aabustamante/Semantic-UI-React\", \"path\": \"src/elements/Label/LabelDetail.d.ts\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "import {Model} from '../../models/base/Model';\nimport {Subject} from 'rxjs/Subject';\nimport {BaseService} from '../BaseService';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {UserRights, UserService} from '../../services/UserService';\nimport {ListTableColumn} from './ListTableColumn';\nimport {BehaviorSubject} from 'rxjs/BehaviorSubject';\nimport {SortDirection} from '../SortDirection';\nimport {ListTableColumnActionType, ListTableColumnType} from './ListEnums';\n\nexport class ListProvider<T extends Model> {\n\n  public currentPage = 1;\n  public itemsPerPage = 10;\n  public totalItems = 0;\n  public dataLoaded = false;\n  public items: Subject<T[]>;\n  public cardTitle = '';\n  public cardIcon = '';\n  public columns: ListTableColumn<T>[];\n  public sortDirection = SortDirection;\n  public columnTypes = ListTableColumnType;\n  public actionTypes = ListTableColumnActionType;\n  protected title = '\u0421\u043f\u0438\u0441\u043e\u043a';\n  private sort = '-id';\n  public getRowClass: (model: T) => { [key: string]: boolean };\n\n  private static getSortKey(column: string, desc: boolean = false): string {\n    let sortKey = column;\n    if (desc) {\n      sortKey = '-' + sortKey;\n    }\n    return sortKey;\n  }\n\n  constructor(private service: BaseService<T>, private router: Router,\n              private route: ActivatedRoute, private _userService: UserService) {\n  }\n\n  public init() {\n    this.items = new BehaviorSubject<T[]>([]);\n    this.route.queryParamMap.subscribe(params => {\n      const pageNumber = parseInt(params.get('page'), 10);\n      if (pageNumber >= 1) {\n        this.currentPage = pageNumber;\n      }\n      const sort = params.get('sort');\n      if (sort != null) {\n        this.sort = sort;\n        const key = this.sort.replace('-', '');\n        const sortDirection = this.sort.indexOf('-') > -1 ? SortDirection.Desc : SortDirection.Asc;\n        this.columns.forEach(col => {\n          col.setSorted(col.Key === key ? sortDirection : null);\n        });\n      }\n      this.load(this.currentPage);\n    });\n  }\n\n  public applySort(column: string) {\n    let sortKey;\n    if (this.sort === column) {\n      sortKey = ListProvider.getSortKey(column, true);\n    } else {\n      sortKey = ListProvider.getSortKey(column);\n    }\n    this.sort = sortKey;\n    this.reload();\n  }\n\n  public changePage(page: number) {\n    this.currentPage = page;\n    this.reload();\n  }\n\n  public load(page?: number) {\n    page = page ? page : this.currentPage;\n    this.service.getList(page, this.itemsPerPage, this.sort).subscribe((res) => {\n      this.items.next(res.data);\n      this.totalItems = res.totalItems;\n      this.currentPage = page;\n      this.dataLoaded = true;\n    });\n  }\n\n  private reload() {\n    this.router.navigate([], {queryParams: {page: this.currentPage, sort: this.sort}, relativeTo: this.route});\n  }\n\n  public can(right: UserRights): boolean {\n    return this._userService.hasRight(right);\n  }\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Excessive callback/promise chaining\", \"suggestion\": \"Refactor to async/await, extract helper functions, and centralize error handling.\", \"extra\": {\"signals\": [\"readability\"], \"evidence\": [\".then count=0, close-brace-paren count=4\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"BioWareRu/Admin\", \"path\": \"src/core/lists/ListProvider.ts\"}}"}
{"instruction": "Analyze this Python code for architectural quality. Return strict JSON.", "input": "# -*- coding: utf-8 -*-\n# Simple script to test sending UTF8 text with the GrowlNotifier class\nimport logging\nlogging.basicConfig(level=logging.DEBUG)\nfrom gntp.notifier import GrowlNotifier\nimport platform\n\ngrowl = GrowlNotifier(notifications=['Testing'],password='password',hostname='ayu')\ngrowl.subscribe(platform.node(),platform.node(),12345)", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Hardcoded secret detected\", \"suggestion\": \"Move secrets to environment variables or a secrets manager (vault/KMS), and rotate exposed keys.\", \"extra\": {\"signals\": [\"security\"], \"evidence\": [\"growl = GrowlNotifier(notifications=['Testing'],password='password',hostname='ayu')\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"kfdm/gntp\", \"path\": \"test/subscribe.py\"}}"}
{"instruction": "Analyze this Java code for architectural quality. Return strict JSON.", "input": "package com.company;\n\nimport java.util.Scanner;\n\npublic class EvenPowersOf2 {\n    public static void main(String[] args) {\n        Scanner scanner = new Scanner(System.in);\n\n        int n = Integer.parseInt(scanner.nextLine());\n        int num = 1;\n\n        for (int i = 0; i <= n ; i+=2) {\n            System.out.println(num);\n            num *= 4;\n        }\n    }\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Use of System.out for logging\", \"suggestion\": \"Use a structured logger (e.g., SLF4J) and consistent log levels; avoid stdout in production.\", \"extra\": {\"signals\": [\"observability\"], \"evidence\": [\"System.out.println(num);\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"ivelin1936/Studing-SoftUni-\", \"path\": \"Programing Basic/Programming Basics - Exercises/Advanced Loops/src/com/company/EvenPowersOf2.java\"}}"}
{"instruction": "Analyze this Java code for security vulnerabilities. Return strict JSON.", "input": "break;\n          case OBJECT:\n            json.startObject(\"person2\");\n            json.field(\"first_name\", \"my_first_name_\" + i);\n            json.field(\"last_name\", \"my_last_name_\" + i);\n            json.field(\"ssn\", 1234 + i);\n            json.endObject();\n            break;\n          case GEO_POINT:\n            json.startObject(\"geo_location_1\");\n            json.field(\"lat\", Math.acos(random.nextDouble() * 2 - 1));\n            json.field(\"lon\", random.nextDouble() * Math.PI * 2);\n            json.endObject();\n            break;\n          case GEO_SHAPE:\n            // XXX - Implement\n            break;\n          default:\n            break;\n        }", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-330)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-330\"], \"cwe\": \"CWE-330\", \"rule\": \"Depending on the context, generating weak random numbers may expose cryptographic functions\\nwhich rely on these numbers, to be exploitable. When generating numbers for sensitive values\\nsuch as tokens, nonces, and cryptographic keys, it is recommended that the `DRBG` instance\\nof `SecureRandom` be used.\\n\"}}"}
{"instruction": "Analyze this Java code for architectural quality. Return strict JSON.", "input": "/*\n * To change this license header, choose License Headers in Project Properties.\n * To change this template file, choose Tools | Templates\n * and open the template in the editor.\n */\npackage config;\n\nimport interfaces.*;\nimport java.sql.*;\nimport java.util.logging.*;\nimport javax.swing.*;\n\n/**\n *\n * @author Luis G\n */\npublic class Connector {\n\n    public Connector() {\n\n    }\n\n    protected boolean getData(String query, Callback callback) {\n        ResultSet rs = null;\n        Connection conn = null;\n        Statement stmt = null;\n        boolean isNull = false;\n        try {\n            connect();\n            conn = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/escuela\", \"root\", \"\");\n            stmt = conn.createStatement();\n            rs = stmt.executeQuery(query);\n            for (int i = 0; rs.next(); i++) {\n                callback.callback(rs, i);\n            }\n            stmt.close();\n            conn.close();\n        } catch (SQLException ex) {\n            Logger.getLogger(Connector.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        return isNull;\n    }\n\n    protected ResultSet getData(String query) {\n        ResultSet rs = null;\n        Connection conn = null;\n        Statement stmt = null;\n        try {\n            connect();\n            conn = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/escuela\", \"root\", \"\");\n            stmt = conn.createStatement();\n            rs = stmt.executeQuery(query);\n        } catch (Exception e) {\n            System.out.println(e);\n        }\n        return rs;\n    }\n\n    protected int executeQuery(String query) {\n        int id = -1;\n        try {\n            connect();\n            Connection conn = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/escuela\", \"root\", \"\");\n            Statement stmt = conn.createStatement();\n            id = stmt.executeUpdate(query, Statement.RETURN_GENERATED_KEYS);\n            ResultSet rs = stmt.getGeneratedKeys();\n            if (rs.next()) {\n                id = rs.getInt(1);\n            }\n            stmt.close();\n            conn.close();\n        } catch (SQLException e) {\n            Logger.getLogger(Connector.class.getName()).log(Level.SEVERE, null, e);\n            switch (e.getErrorCode()) {\n                case 1062:\n                    JOptionPane.showMessageDialog(null, \"Ese correo ya esta registrado\", \"error\", 0);\n                    break;\n                case 1054:\n                    JOptionPane.showMessageDialog(null, \"El registro no existe\", \"error\", 0);\n                    break;\n                default:\n                    JOptionPane.showMessageDialog(null, \"A ocurrido un error \" + e, \"error\", 0);\n                    System.out.println(e);\n                    break;\n            }\n        }\n        return id;\n    }\n\n    private void connect() {\n        try {\n            Class.forName(\"com.mysql.jdbc.Driver\");\n        } catch (Exception e) {\n        }\n    }\n\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Use of System.out for logging\", \"suggestion\": \"Use a structured logger (e.g., SLF4J) and consistent log levels; avoid stdout in production.\", \"extra\": {\"signals\": [\"observability\"], \"evidence\": [\"System.out.println(e);\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"Luis-Gdx/escuela\", \"path\": \"Topicos Avanzados de Programacion/Tabla/Tabla con base de datos y login/src/config/Connector.java\"}}"}
{"instruction": "Analyze this Javascript code for security vulnerabilities. Return strict JSON.", "input": "},\n\n  _getTemplateRawFile: function _getTemplateRawFile() {\n    var cached = cachedTemplate[this.templateName];\n    if (cached) {\n      this.preprocessedTemplate = cached;\n      this.onOperationDone(RESULT_GOT_CACHED_TEMPLATE);\n    } else {\n      try {\n        this.rawTemplate =\n          fs.readFileSync(config.templateDir + \"/\" + this.templateName, 'utf8');\n      } catch (err) {\n        this.onOperationDone(RESULT_ERROR, err);\n        return;\n      }\n      this.onOperationDone(RESULT_OK);\n    };\n  },\n\n  onOperationDone: function(result, err) {", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-22)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-22\"], \"cwe\": \"CWE-22\", \"rule\": \"The application dynamically constructs file or path information. If the path\\ninformation comes from user-supplied input, it could be abused to read sensitive files,\\naccess other users' data, or aid in exploitation to gain further system access.\\n\"}}"}
{"instruction": "Analyze this Java code for architectural quality. Return strict JSON.", "input": "package de.hilling.maven.release.testprojects.versioninheritor;\n\npublic class App {\n    public static void main(String[] args) {\n        System.out.println(\"1 + 2 = 3\");\n    }\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Use of System.out for logging\", \"suggestion\": \"Use a structured logger (e.g., SLF4J) and consistent log levels; avoid stdout in production.\", \"extra\": {\"signals\": [\"observability\"], \"evidence\": [\"System.out.println(\\\"1 + 2 = 3\\\");\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"guhilling/smart-release-plugin\", \"path\": \"test-projects/ear-project/project-lib/src/main/java/de/hilling/maven/release/testprojects/versioninheritor/App.java\"}}"}
{"instruction": "Analyze this Javascript code for architectural quality. Return strict JSON.", "input": "import {Component} from 'react'\n\nexport class Greeter {\n  constructor (message) {\n    this.greeting = message;\n  }\n\n  greetFrom (...names) {\n    let suffix = names.reduce((s, n) => s + \", \" + n.toUpperCase());\n    return \"Hello, \" + this.greeting + \" from \" + suffix;\n  }\n\n  greetNTimes ({name, times}) {\n    let greeting = this.greetFrom(name);\n    for (let i = 0; i < times; i++) {\n      console.log(greeting)\n    }\n  }\n}\n\nnew Greeter(\"foo\").greetNTimes({name: \"Webstorm\", times: 3})\n\n\nfunction foo (x, y, z) {\n  var i = 0;\n  var x = {0: \"zero\", 1: \"one\"};\n  var a = [0, 1, 2];\n  var foo = function () {\n  }\n  var asyncFoo = async (x, y, z) => {\n  }\n  var v = x.map(s => s.length);\n  if (!i > 10) {\n    for (var j = 0; j < 10; j++) {\n      switch (j) {\n        case 0:\n          value = \"zero\";\n          break;\n        case 1:\n          value = \"one\";\n          break;\n      }\n      var c = j > 5 ? \"GT 5\" : \"LE 5\";\n    }\n  } else {\n    var j = 0;\n    try {\n      while (j < 10) {\n        if (i == j || j > 5) {\n          a[j] = i + j * 12;\n        }\n        i = (j << 2) & 4;\n        j++;\n      }\n      do {\n        j--;\n      } while (j > 0)\n    } catch (e) {\n      alert(\"Failure: \" + e.message);\n    } finally {\n      reset(a, i);\n    }\n  }\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Javascript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Legacy 'var' usage\", \"suggestion\": \"Prefer 'const' by default; use 'let' when reassignment is needed.\", \"extra\": {\"signals\": [\"modern-standards\"], \"evidence\": [\"var i = 0;\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"doasync/eslint-config-airbnb-standard\", \"path\": \"example.js\"}}"}
{"instruction": "Analyze this Python code for architectural quality. Return strict JSON.", "input": "import django\n\n\n# Django 1.5 add support for custom auth user model\nfrom django.conf import settings\n\nif django.VERSION >= (1, 5):\n    AUTH_USER_MODEL = settings.AUTH_USER_MODEL\nelse:\n    try:\n        from django.contrib.auth.models import User\n        AUTH_USER_MODEL = 'auth.User'\n    except ImportError:\n        raise ImportError(u\"User model is not to be found.\")\n\n# location of patterns, url, include changes in 1.4 onwards\ntry:\n    from django.conf.urls import patterns, url, include\nexcept:\n    from django.conf.urls.defaults import patterns, url, include", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Bare 'except:' block\", \"suggestion\": \"Catch specific exceptions and handle/log them appropriately; avoid swallowing unknown errors.\", \"extra\": {\"signals\": [\"error-handling\"], \"evidence\": [\"@L19: except:\"], \"confidence\": \"high\", \"license\": \"mit\", \"repo\": \"maroux/django-relationships\", \"path\": \"relationships/compat.py\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "import { delay } from \"../delay\"\nimport { getOneTrustConsent } from \"../getOneTrustConsent\"\nimport { oneTrustReady } from \"../oneTrustReady\"\n\njest.mock(\"../delay\")\njest.mock(\"../oneTrustReady\")\n\ndescribe(\"getOneTrustConsent\", () => {\n  const delayMock = delay as jest.Mock\n  const oneTrustReadyMock = oneTrustReady as jest.Mock\n\n  beforeEach(() => {\n    delayMock.mockImplementation(() => Promise.resolve())\n  })\n\n  afterEach(() => {\n    delayMock.mockRestore()\n    oneTrustReadyMock.mockRestore()\n  })\n\n  it(\"returns empty string if onetrust is never ready\", async () => {\n    oneTrustReadyMock.mockImplementation(() => {\n      return false\n    })\n    const result = await getOneTrustConsent()\n    expect(delayMock).toHaveBeenCalledWith(10)\n    expect(delayMock).toHaveBeenCalledTimes(101)\n    expect(oneTrustReadyMock).toHaveBeenCalledWith()\n    expect(oneTrustReadyMock).toHaveBeenCalledTimes(103)\n    expect(result).toBe(\"\")\n  })\n  it(\"returns onetrust consent string if onetrust is ready\", async () => {\n    oneTrustReadyMock.mockImplementation(() => {\n      return true\n    })\n    window.OnetrustActiveGroups = \"C0001\"\n    const result = await getOneTrustConsent()\n    expect(delayMock).not.toHaveBeenCalled()\n    expect(oneTrustReadyMock).toHaveBeenCalledWith()\n    expect(result).toBe(\"C0001\")\n  })\n})", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Excessive callback/promise chaining\", \"suggestion\": \"Refactor to async/await, extract helper functions, and centralize error handling.\", \"extra\": {\"signals\": [\"readability\"], \"evidence\": [\".then count=0, close-brace-paren count=7\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"artsy/force\", \"path\": \"src/lib/analytics/segmentOneTrustIntegration/__tests__/getOneTrustConsent.jest.ts\"}}"}
{"instruction": "Analyze this Python code for architectural quality. Return strict JSON.", "input": "import os\nimport numpy as np\n\n\nclass Dataset(object):\n    \"\"\"\n    This class represents a dataset and consists of a list of SongData along with some metadata about the dataset\n    \"\"\"\n\n    def __init__(self, songs_data=None):\n        if songs_data is None:\n            self.songs_data = []\n        else:\n            self.songs_data = songs_data\n\n    def add_song(self, song_data):\n        self.songs_data.append(song_data)\n\n    def songs(self):\n        for s in self.songs_data:\n            yield s\n\n    @property\n    def num_features(self):\n        if len(self.songs_data):\n            return self.songs_data[0].X.shape[1]\n\n    @property\n    def size(self):\n        return len(self.songs_data)\n\n    def __repr__(self):\n        return ', '.join([s.name for s in self.songs()])\n\n\nclass SongData(object):\n    \"\"\"\n    This class holds features, labels, and metadata for a song.\n    \"\"\"\n\n    def __init__(self, audio_path, label_path):\n        if not os.path.isfile(audio_path):\n            raise IOError(\"Audio file at %s does not exist\" % audio_path)\n        if label_path and not os.path.isfile(label_path):\n            raise IOError(\"MIDI file at %s does not exist\" % label_path)\n\n        self.audio_path = audio_path\n        self.label_path = label_path\n\n    \"\"\"\n    x [num_samples,] is the samples of the song\n    \"\"\"\n    @property\n    def x(self):\n        return self.__x\n\n    @x.setter\n    def x(self, x):\n        self.__x = x\n\n    \"\"\"\n    X [num_frames x num_features] is the feature matrix for the song\n    \"\"\"\n    @property\n    def X(self):\n        return self.__X\n\n    @X.setter\n    def X(self, X):\n        if hasattr(self, 'Y') and self.Y.shape[0] != X.shape[0]:\n            raise ValueError(\"Number of feature frames must equal number of label frames\")\n        self.__X = X\n\n    \"\"\"\n    Y [num_frames x num_pitches] is the label matrix for the song\n    \"\"\"\n    @property\n    def Y(self):\n        return self.__Y\n\n    @Y.setter\n    def Y(self, Y):\n        if hasattr(self, 'X') and self.X.shape[0] != Y.shape[0]:\n            raise ValueError(\"Number of label frames must equal number of feature frames\")\n        self.__Y = Y\n\n    @property\n    def num_pitches(self):\n        if hasattr(self, 'Y'):\n            return np.shape(self.Y)[1]\n        return 0\n\n    @property\n    def num_features(self):\n        if hasattr(self, 'X'):\n            return self.X.shape[1]\n\n    @property\n    def num_frames(self):\n        if hasattr(self, 'X'):\n            return self.X.shape[0]\n\n    @property\n    def name(self):\n        return os.path.splitext(os.path.split(self.audio_path)[-1])[0]", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Low cohesion: class 'SongData' has many methods (11)\", \"suggestion\": \"Split 'SongData' into smaller classes/modules by responsibility.\", \"extra\": {\"signals\": [\"cohesion\"], \"evidence\": [\"class SongData @L36: class SongData(object):\"], \"confidence\": \"high\", \"license\": \"mit\", \"repo\": \"Guitar-Machine-Learning-Group/guitar-transcriber\", \"path\": \"dataset.py\"}}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "private static final String JWT_SECRET = \"my-secret-key-123\";", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Hardcoded Secret\", \"message\": \"JWT secret in source code enables token forgery\", \"suggestion\": \"Load from environment: System.getenv(\\\"JWT_SECRET\\\")\"}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "/* eslint-disable promise/always-return */\nimport { runAuthenticatedQuery } from \"schema/v2/test/utils\"\nimport gql from \"lib/gql\"\n\ndescribe(\"Me\", () => {\n  describe(\"ShowsByFollowedArtists\", () => {\n    it(\"returns shows by followed artists\", async () => {\n      const query = gql`\n        {\n          me {\n            showsByFollowedArtists(\n              first: 100\n              sort: NAME_ASC\n              status: UPCOMING\n            ) {\n              totalCount\n              edges {\n                node {\n                  name\n                }\n              }\n            }\n          }\n        }\n      `\n\n      const expectedConnectionData = {\n        totalCount: 2,\n        edges: [\n          {\n            node: {\n              name: \"Show 1\",\n            },\n          },\n          {\n            node: {\n              name: \"Show 2\",\n            },\n          },\n        ],\n      }\n\n      const followedArtistsShowsLoader = jest.fn(async () => ({\n        headers: { \"x-total-count\": 2 },\n        body: [\n          {\n            name: \"Show 1\",\n          },\n          {\n            name: \"Show 2\",\n          },\n        ],\n      }))\n\n      const context = {\n        meLoader: () => Promise.resolve({}),\n        followedArtistsShowsLoader,\n      }\n\n      const {\n        me: { showsByFollowedArtists },\n      } = await runAuthenticatedQuery(query, context)\n\n      expect(showsByFollowedArtists).toEqual(expectedConnectionData)\n\n      expect(followedArtistsShowsLoader).toHaveBeenCalledWith({\n        offset: 0,\n        size: 100,\n        sort: \"name\",\n        status: \"upcoming\",\n        total_count: true,\n      })\n    })\n  })\n})", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Excessive callback/promise chaining\", \"suggestion\": \"Refactor to async/await, extract helper functions, and centralize error handling.\", \"extra\": {\"signals\": [\"readability\"], \"evidence\": [\".then count=0, close-brace-paren count=6\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"artsy/metaphysics\", \"path\": \"src/schema/v2/me/__tests__/showsByFollowedArtists.test.ts\"}}"}
{"instruction": "Analyze this Python code for security vulnerabilities. Return strict JSON.", "input": "hostname = re.sub('[ _]', '-', hostname)\n    hostname = re.sub('[^\\w.-]+', '', hostname)\n    hostname = hostname.lower()\n    hostname = hostname.strip('.-')\n\n    return hostname\n\n\ndef hash_file(file_like_object):\n    \"\"\"Generate a hash for the contents of a file.\"\"\"\n    checksum = hashlib.sha1()\n    any(map(checksum.update, iter(lambda: file_like_object.read(32768), b'')))\n    return checksum.hexdigest()\n\n\ndef service_is_up(service):\n    \"\"\"Check whether a service is up based on last heartbeat.\"\"\"\n    last_heartbeat = service['updated_at'] or service['created_at']\n    # Timestamps in DB are UTC.\n    elapsed = (timeutils.utcnow(with_timezone=True) -", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-328)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-328\"], \"cwe\": \"CWE-328\", \"rule\": \"\\\\bhashlib\\\\.sha1\\\\(\"}}"}
{"instruction": "Analyze this Java code for architectural quality. Return strict JSON.", "input": "/**\r\n * Created by Administrator on 2017/3/11.\r\n */\r\npublic class ReverseWordsInSequence {\r\n    public void reverseSequence(String str) {\r\n        if (str == null) return;\r\n        String[] strArray = str.split(\" \");\r\n        StringBuilder sb = new StringBuilder();\r\n        for (int i = strArray.length-1; i >= 0; --i)\r\n            sb.append(strArray[i] + \" \");\r\n        System.out.println(sb);\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        ReverseWordsInSequence r = new ReverseWordsInSequence();\r\n        String str = \"I am a Students.\";\r\n        r.reverseSequence(str);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Created by Administrator on 2017/3/11.\r\n */\r\npublic class ReverseWordsInSequence {\r\n\r\n    public String reverseSequence(String str) {\r\n        if (str == null || str.length() <= 1)\r\n            return str;\r\n        StringBuilder sb = new StringBuilder(str);\r\n        reverse(sb, 0, str.length() - 1);\r\n        int begin = 0, end = 0;\r\n\r\n        while (end < str.length()) {\r\n            while (end < str.length() && sb.charAt(end) != ' ')\r\n                end++;\r\n            reverse(sb, begin, end - 1);\r\n            begin = end + 1;\r\n            end = begin;\r\n        }\r\n        return sb.toString();\r\n    }\r\n\r\n    public void reverse(StringBuilder sb, int start, int end) {\r\n        if (sb == null || end <= start)\r\n            return;\r\n\r\n        while (start < end) {\r\n            char temp = sb.charAt(start);\r\n            sb.setCharAt(start, sb.charAt(end));\r\n            sb.setCharAt(end, temp);\r\n            start++;\r\n            end--;\r\n        }\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        ReverseWordsInSequence r = new ReverseWordsInSequence();\r\n        String str = \"i am a students.\";\r\n        System.out.print(r.reverseSequence(str));\r\n    }\r\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Use of System.out for logging\", \"suggestion\": \"Use a structured logger (e.g., SLF4J) and consistent log levels; avoid stdout in production.\", \"extra\": {\"signals\": [\"observability\"], \"evidence\": [\"System.out.println(sb);\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"RudyZH/Aim2Offer\", \"path\": \"042_ReverseWordsInSequence.java\"}}"}
{"instruction": "Analyze this Python code for security vulnerabilities. Return strict JSON.", "input": "oldflags = setDLFlags()\n\n    percentStep = 100.0 / len(vtkImportList)\n    currentPercent = 0.0\n\n    # do the imports\n    for module, message in vtkImportList:\n        currentPercent += percentStep\n        progressMethod(currentPercent, 'Initialising vtk_kit: %s' % (message,),\n                       noTime=True)\n        exec('import %s' % (module,))\n\n    # restore previous dynamic loading flags\n    resetDLFlags(oldflags)\n\ndef setDLFlags():\n    # brought over from ITK Wrapping/CSwig/Python\n\n    # Python \"help(sys.setdlopenflags)\" states:\n    #", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Automated Code Review\", \"message\": \"Vulnerability detected (CWE: CWE-94)\", \"suggestion\": \"Use secure coding practices appropriate to the vulnerability: validate/sanitize inputs, avoid dangerous APIs, use parameterized queries, and apply output encoding at trust boundaries.\", \"extra\": {\"source\": \"CyberSecEval\", \"confidence\": \"high\", \"signals\": [\"security\", \"cwe-CWE-94\"], \"cwe\": \"CWE-94\", \"rule\": \"Potential code injection due to exec usage.\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "import { OnInit, SimpleChanges, OnChanges } from '@angular/core';\nimport { Validator, AbstractControl } from '@angular/forms';\nexport declare class NotEqualValidator implements Validator, OnInit, OnChanges {\n    notEqual: any;\n    private validator;\n    private onChange;\n    ngOnInit(): void;\n    ngOnChanges(changes: SimpleChanges): void;\n    validate(c: AbstractControl): {\n        [key: string]: any;\n    };\n    registerOnValidatorChange(fn: () => void): void;\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Type safety weakened by 'any'\", \"suggestion\": \"Replace 'any' with specific interfaces/types or 'unknown' + narrowing.\", \"extra\": {\"signals\": [\"type-safety\"], \"evidence\": [\"notEqual: any;\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"Dackng/eh-unmsm-client\", \"path\": \"node_modules/ng2-validation/dist/not-equal/directive.d.ts\"}}"}
{"instruction": "Analyze this Typescript code for architectural quality. Return strict JSON.", "input": "import { expect } from 'chai';\n\nimport { Curry } from './curry';\n\ndescribe('curry', () => {\n  it('should curry the method with default arity', () => {\n    class MyClass {\n      @Curry()\n      add(a: any, b?: any) {\n        return a + b;\n      }\n    }\n\n    const myClass = new MyClass();\n    const add5 = myClass.add(5);\n\n    expect(add5).to.be.an.instanceOf(Function);\n    expect(add5(10)).to.equal(15);\n  });\n\n  it('should curry the method with default arity (paramless)', () => {\n    class MyClass {\n      @Curry\n      add(a: any, b?: any) {\n        return a + b;\n      }\n    }\n\n    const myClass = new MyClass();\n    const add5 = myClass.add(5);\n\n    expect(add5).to.be.an.instanceOf(Function);\n    expect(add5(10)).to.equal(15);\n  });\n\n  it('should curry the method with fixed arity', () => {\n    class MyClass {\n      @Curry(2)\n      add(a: any, b?: any, c?: any) {\n        return a + b * c;\n      }\n    }\n\n    const myClass = new MyClass();\n    const add5 = myClass.add(5);\n\n    expect(add5).to.be.an.instanceOf(Function);\n    expect(add5(10, 2)).to.equal(25);\n  });\n\n  it('should retain the class context', () => {\n    class MyClass {\n      value = 10;\n\n      @Curry()\n      add(a: any, b?: any): any {\n        return (a + b) * this.value;\n      }\n    }\n\n    const myClass = new MyClass();\n    const add5 = myClass.add(5);\n\n    expect(add5(2)).to.equal(70);\n  });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Typescript\", \"title\": \"Automated Code Review\", \"message\": \"Architectural issues detected: Excessive callback/promise chaining; Type safety weakened by 'any'\", \"suggestion\": \"Refactor to async/await, extract helper functions, and centralize error handling. Replace 'any' with specific interfaces/types or 'unknown' + narrowing.\", \"extra\": {\"signals\": [\"readability\", \"type-safety\"], \"evidence\": [\".then count=0, close-brace-paren count=5\", \"add(a: any, b?: any) {\"], \"confidence\": \"medium\", \"license\": \"mit\", \"repo\": \"steelsojka/lodash-decorators\", \"path\": \"src/curry.spec.ts\"}}"}

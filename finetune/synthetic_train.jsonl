{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String query = \"SELECT * FROM users WHERE id = \" + userId;\nStatement stmt = conn.createStatement();\nResultSet rs = stmt.executeQuery(query);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"SQL Injection\", \"message\": \"Direct string concatenation in SQL creates injection vulnerability\", \"suggestion\": \"Use PreparedStatement with parameterized queries\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Service\npublic class OrderService {\n    void validate() {}\n    void charge() {}\n    void email() {}\n    void log() {}\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"God Class\", \"message\": \"Single class handling multiple responsibilities violates SRP\", \"suggestion\": \"Split into OrderValidator, PaymentProcessor, EmailService\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "private static final String JWT_SECRET = \"my-secret-key-123\";", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Hardcoded Secret\", \"message\": \"JWT secret in source code enables token forgery\", \"suggestion\": \"Load from environment: System.getenv(\\\"JWT_SECRET\\\")\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@GetMapping(\"/users/{id}\")\npublic User getUser(@PathVariable Long id) {\n    return userRepo.findById(id).get();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Entity Exposure\", \"message\": \"JPA entities exposed to API layer leak database schema\", \"suggestion\": \"Create DTOs for API contracts, map in service layer\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String path = \"/uploads/\" + request.getParameter(\"filename\");\nFile file = new File(path);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Path Traversal\", \"message\": \"Unsanitized filename allows directory traversal attacks\", \"suggestion\": \"Use Paths.get(filename).getFileName() or UUID.randomUUID()\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public void transfer(Account from, Account to, BigDecimal amount) {\n    from.debit(amount);\n    to.credit(amount);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Missing Transaction\", \"message\": \"Multi-step database operations without @Transactional risk partial updates\", \"suggestion\": \"Add @Transactional to ensure atomicity\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public class UserService {\n    private EmailService emailService = new EmailService();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Tight Coupling\", \"message\": \"Direct instantiation creates hard dependencies\", \"suggestion\": \"Use dependency injection via constructor\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nDocument doc = factory.newDocumentBuilder().parse(inputStream);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"XXE Vulnerability\", \"message\": \"XML parser without disabling external entities\", \"suggestion\": \"factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "InputStream is = new FileInputStream(file);\nString content = new String(is.readAllBytes());\nis.close();", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Resource Leak\", \"message\": \"InputStream not closed on exception\", \"suggestion\": \"Use try-with-resources\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Async\npublic CompletableFuture<User> getUser(Long id) {\n    return CompletableFuture.completedFuture(restTemplate.getForObject(url, User.class));\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Synchronous in Async\", \"message\": \"Blocking call in async method defeats reactive programming\", \"suggestion\": \"Use WebClient or reactive database drivers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import pickle\nwith open(file_path, \"rb\") as f:\n    data = pickle.load(f)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Pickle Vulnerability\", \"message\": \"Deserializing untrusted pickle enables arbitrary code execution\", \"suggestion\": \"Use JSON/joblib or restrict with __reduce_ex__ override\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async def fetch(url):\n    response = requests.get(url)\n    return response.json()", "output": "{\"severity\": \"CRITICAL\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Blocking Event Loop\", \"message\": \"Synchronous I/O in async corrupts event loop performance\", \"suggestion\": \"Use aiohttp: async with session.get(url) as resp\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def add_item(item, items=[]):\n    items.append(item)\n    return items", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Mutable Default\", \"message\": \"Mutable default arguments share state across calls\", \"suggestion\": \"Use None: def func(items=None): items = items or []\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import  subprocess\nsubprocess.call(f\"echo {user_input}\", shell=True)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Command Injection\", \"message\": \"User input in shell command enables arbitrary execution\", \"suggestion\": \"Use list args: subprocess.run([\\\"cmd\\\", arg])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "API_KEY = \"sk-1234567890abcdef\"\nheaders = {\"Authorization\": f\"Bearer {API_KEY}\"}", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Hardcoded Credentials\", \"message\": \"API keys in source code leak in VCS\", \"suggestion\": \"Use os.getenv(\\\"API_KEY\\\") or secret managers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "# module_a.py\nfrom module_b import ClassB\n\nclass ClassA:\n    def use(self): ClassB()", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Circular Import\", \"message\": \"Mutual imports create coupling and runtime errors\", \"suggestion\": \"Refactor to shared module or use lazy imports\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "try:\n    risky_operation()\nexcept:\n    pass", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Bare Except\", \"message\": \"Catching all exceptions hides errors and hampers debugging\", \"suggestion\": \"Catch specific exceptions: except ValueError\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def process(data):\n    result = transform(data)\n    return result", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Missing Type Hints\", \"message\": \"Dynamic typing without hints reduces code clarity\", \"suggestion\": \"Add type hints: def func(x: int) -> str\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "cursor.execute(f\"SELECT * FROM users WHERE name = '{name}'\")", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"SQL Injection\", \"message\": \"String formatting in SQL queries enables injection\", \"suggestion\": \"Use parameterized queries: cursor.execute(sql, (val,))\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "counter = 0\ndef increment():\n    global counter\n    counter += 1", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Global State\", \"message\": \"Global variables create hidden dependencies\", \"suggestion\": \"Use dependency injection or class attributes\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "useEffect(() => {\n    fetchUser(userId);\n}, []);", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Missing Dependencies\", \"message\": \"useEffect without proper deps causes stale closures\", \"suggestion\": \"Add all dependencies: useEffect(() => {...}, [userId])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<div dangerouslySetInnerHTML={{ __html: userContent }} />", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"XSS Vulnerability\", \"message\": \"Unsanitized HTML rendering enables script injection\", \"suggestion\": \"Use DOMPurify.sanitize() before rendering\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "getData(result => {\n    process(result, processed => {\n        save(processed, response => callback(response));\n    });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Callback Hell\", \"message\": \"Nested callbacks create unmaintainable pyramid of doom\", \"suggestion\": \"Use async/await: const r = await getData(); await process(r)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const user = await User.findOne({ username: req.body.username });", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"NoSQL Injection\", \"message\": \"Unsanitized MongoDB queries enable data extraction\", \"suggestion\": \"Validate input types and use schema validation\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const config = {};\nObject.assign(config, JSON.parse(userInput));", "output": "{\"severity\": \"WARNING\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Prototype Pollution\", \"message\": \"Object.assign with untrusted input pollutes prototypes\", \"suggestion\": \"Validate keys or use Object.create(null)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "function process(data: any): any {\n    return data.map((x: any) => x.value);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Any Type Abuse\", \"message\": \"Type assertions to any eliminate type safety\", \"suggestion\": \"Define proper interfaces for type safety\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<Component user={user} theme={theme} settings={settings} />", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Prop Drilling\", \"message\": \"Passing props through multiple layers creates coupling\", \"suggestion\": \"Use React Context or state management library\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async function save() {}\nsave(); // Fire and forget", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Ignoring Promises\", \"message\": \"Async functions called without await or .catch()\", \"suggestion\": \"Add await or .catch() for error handling\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const result = eval(userInput);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Eval Injection\", \"message\": \"Using eval() with user input enables code execution\", \"suggestion\": \"Use JSON.parse() or safe expression evaluators\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const addItem = () => {\n    items.push(newItem);\n    setItems(items);\n};", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"State Mutation\", \"message\": \"Directly mutating state breaks React rendering\", \"suggestion\": \"Use immutable updates: setState([...items, newItem])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String query = \"SELECT * FROM users WHERE id = \" + userId;\nStatement stmt = conn.createStatement();\nResultSet rs = stmt.executeQuery(query);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"SQL Injection\", \"message\": \"Direct string concatenation in SQL creates injection vulnerability\", \"suggestion\": \"Use PreparedStatement with parameterized queries\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Service\npublic class OrderService {\n    void validate() {}\n    void charge() {}\n    void email() {}\n    void log() {}\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"God Class\", \"message\": \"Single class handling multiple responsibilities violates SRP\", \"suggestion\": \"Split into OrderValidator, PaymentProcessor, EmailService\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "private static final String JWT_SECRET = \"my-secret-key-123\";", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Hardcoded Secret\", \"message\": \"JWT secret in source code enables token forgery\", \"suggestion\": \"Load from environment: System.getenv(\\\"JWT_SECRET\\\")\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@GetMapping(\"/users/{id}\")\npublic User getUser(@PathVariable Long id) {\n    return userRepo.findById(id).get();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Entity Exposure\", \"message\": \"JPA entities exposed to API layer leak database schema\", \"suggestion\": \"Create DTOs for API contracts, map in service layer\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String path = \"/uploads/\" + request.getParameter(\"filename\");\nFile file = new File(path);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Path Traversal\", \"message\": \"Unsanitized filename allows directory traversal attacks\", \"suggestion\": \"Use Paths.get(filename).getFileName() or UUID.randomUUID()\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public void transfer(Account from, Account to, BigDecimal amount) {\n    from.debit(amount);\n    to.credit(amount);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Missing Transaction\", \"message\": \"Multi-step database operations without @Transactional risk partial updates\", \"suggestion\": \"Add @Transactional to ensure atomicity\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public class UserService {\n    private EmailService emailService = new EmailService();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Tight Coupling\", \"message\": \"Direct instantiation creates hard dependencies\", \"suggestion\": \"Use dependency injection via constructor\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nDocument doc = factory.newDocumentBuilder().parse(inputStream);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"XXE Vulnerability\", \"message\": \"XML parser without disabling external entities\", \"suggestion\": \"factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "InputStream is = new FileInputStream(file);\nString content = new String(is.readAllBytes());\nis.close();", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Resource Leak\", \"message\": \"InputStream not closed on exception\", \"suggestion\": \"Use try-with-resources\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Async\npublic CompletableFuture<User> getUser(Long id) {\n    return CompletableFuture.completedFuture(restTemplate.getForObject(url, User.class));\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Synchronous in Async\", \"message\": \"Blocking call in async method defeats reactive programming\", \"suggestion\": \"Use WebClient or reactive database drivers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import pickle\nwith open(file_path, \"rb\") as f:\n    data = pickle.load(f)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Pickle Vulnerability\", \"message\": \"Deserializing untrusted pickle enables arbitrary code execution\", \"suggestion\": \"Use JSON/joblib or restrict with __reduce_ex__ override\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async def fetch(url):\n    response = requests.get(url)\n    return response.json()", "output": "{\"severity\": \"CRITICAL\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Blocking Event Loop\", \"message\": \"Synchronous I/O in async corrupts event loop performance\", \"suggestion\": \"Use aiohttp: async with session.get(url) as resp\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def add_item(item, items=[]):\n    items.append(item)\n    return items", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Mutable Default\", \"message\": \"Mutable default arguments share state across calls\", \"suggestion\": \"Use None: def func(items=None): items = items or []\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import  subprocess\nsubprocess.call(f\"echo {user_input}\", shell=True)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Command Injection\", \"message\": \"User input in shell command enables arbitrary execution\", \"suggestion\": \"Use list args: subprocess.run([\\\"cmd\\\", arg])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "API_KEY = \"sk-1234567890abcdef\"\nheaders = {\"Authorization\": f\"Bearer {API_KEY}\"}", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Hardcoded Credentials\", \"message\": \"API keys in source code leak in VCS\", \"suggestion\": \"Use os.getenv(\\\"API_KEY\\\") or secret managers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "# module_a.py\nfrom module_b import ClassB\n\nclass ClassA:\n    def use(self): ClassB()", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Circular Import\", \"message\": \"Mutual imports create coupling and runtime errors\", \"suggestion\": \"Refactor to shared module or use lazy imports\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "try:\n    risky_operation()\nexcept:\n    pass", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Bare Except\", \"message\": \"Catching all exceptions hides errors and hampers debugging\", \"suggestion\": \"Catch specific exceptions: except ValueError\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def process(data):\n    result = transform(data)\n    return result", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Missing Type Hints\", \"message\": \"Dynamic typing without hints reduces code clarity\", \"suggestion\": \"Add type hints: def func(x: int) -> str\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "cursor.execute(f\"SELECT * FROM users WHERE name = '{name}'\")", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"SQL Injection\", \"message\": \"String formatting in SQL queries enables injection\", \"suggestion\": \"Use parameterized queries: cursor.execute(sql, (val,))\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "counter = 0\ndef increment():\n    global counter\n    counter += 1", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Global State\", \"message\": \"Global variables create hidden dependencies\", \"suggestion\": \"Use dependency injection or class attributes\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "useEffect(() => {\n    fetchUser(userId);\n}, []);", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Missing Dependencies\", \"message\": \"useEffect without proper deps causes stale closures\", \"suggestion\": \"Add all dependencies: useEffect(() => {...}, [userId])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<div dangerouslySetInnerHTML={{ __html: userContent }} />", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"XSS Vulnerability\", \"message\": \"Unsanitized HTML rendering enables script injection\", \"suggestion\": \"Use DOMPurify.sanitize() before rendering\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "getData(result => {\n    process(result, processed => {\n        save(processed, response => callback(response));\n    });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Callback Hell\", \"message\": \"Nested callbacks create unmaintainable pyramid of doom\", \"suggestion\": \"Use async/await: const r = await getData(); await process(r)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const user = await User.findOne({ username: req.body.username });", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"NoSQL Injection\", \"message\": \"Unsanitized MongoDB queries enable data extraction\", \"suggestion\": \"Validate input types and use schema validation\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const config = {};\nObject.assign(config, JSON.parse(userInput));", "output": "{\"severity\": \"WARNING\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Prototype Pollution\", \"message\": \"Object.assign with untrusted input pollutes prototypes\", \"suggestion\": \"Validate keys or use Object.create(null)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "function process(data: any): any {\n    return data.map((x: any) => x.value);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Any Type Abuse\", \"message\": \"Type assertions to any eliminate type safety\", \"suggestion\": \"Define proper interfaces for type safety\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<Component user={user} theme={theme} settings={settings} />", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Prop Drilling\", \"message\": \"Passing props through multiple layers creates coupling\", \"suggestion\": \"Use React Context or state management library\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async function save() {}\nsave(); // Fire and forget", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Ignoring Promises\", \"message\": \"Async functions called without await or .catch()\", \"suggestion\": \"Add await or .catch() for error handling\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const result = eval(userInput);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Eval Injection\", \"message\": \"Using eval() with user input enables code execution\", \"suggestion\": \"Use JSON.parse() or safe expression evaluators\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const addItem = () => {\n    items.push(newItem);\n    setItems(items);\n};", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"State Mutation\", \"message\": \"Directly mutating state breaks React rendering\", \"suggestion\": \"Use immutable updates: setState([...items, newItem])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String query = \"SELECT * FROM users WHERE id = \" + userId;\nStatement stmt = conn.createStatement();\nResultSet rs = stmt.executeQuery(query);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"SQL Injection\", \"message\": \"Direct string concatenation in SQL creates injection vulnerability\", \"suggestion\": \"Use PreparedStatement with parameterized queries\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Service\npublic class OrderService {\n    void validate() {}\n    void charge() {}\n    void email() {}\n    void log() {}\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"God Class\", \"message\": \"Single class handling multiple responsibilities violates SRP\", \"suggestion\": \"Split into OrderValidator, PaymentProcessor, EmailService\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "private static final String JWT_SECRET = \"my-secret-key-123\";", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Hardcoded Secret\", \"message\": \"JWT secret in source code enables token forgery\", \"suggestion\": \"Load from environment: System.getenv(\\\"JWT_SECRET\\\")\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@GetMapping(\"/users/{id}\")\npublic User getUser(@PathVariable Long id) {\n    return userRepo.findById(id).get();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Entity Exposure\", \"message\": \"JPA entities exposed to API layer leak database schema\", \"suggestion\": \"Create DTOs for API contracts, map in service layer\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String path = \"/uploads/\" + request.getParameter(\"filename\");\nFile file = new File(path);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Path Traversal\", \"message\": \"Unsanitized filename allows directory traversal attacks\", \"suggestion\": \"Use Paths.get(filename).getFileName() or UUID.randomUUID()\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public void transfer(Account from, Account to, BigDecimal amount) {\n    from.debit(amount);\n    to.credit(amount);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Missing Transaction\", \"message\": \"Multi-step database operations without @Transactional risk partial updates\", \"suggestion\": \"Add @Transactional to ensure atomicity\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public class UserService {\n    private EmailService emailService = new EmailService();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Tight Coupling\", \"message\": \"Direct instantiation creates hard dependencies\", \"suggestion\": \"Use dependency injection via constructor\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nDocument doc = factory.newDocumentBuilder().parse(inputStream);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"XXE Vulnerability\", \"message\": \"XML parser without disabling external entities\", \"suggestion\": \"factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "InputStream is = new FileInputStream(file);\nString content = new String(is.readAllBytes());\nis.close();", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Resource Leak\", \"message\": \"InputStream not closed on exception\", \"suggestion\": \"Use try-with-resources\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Async\npublic CompletableFuture<User> getUser(Long id) {\n    return CompletableFuture.completedFuture(restTemplate.getForObject(url, User.class));\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Synchronous in Async\", \"message\": \"Blocking call in async method defeats reactive programming\", \"suggestion\": \"Use WebClient or reactive database drivers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import pickle\nwith open(file_path, \"rb\") as f:\n    data = pickle.load(f)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Pickle Vulnerability\", \"message\": \"Deserializing untrusted pickle enables arbitrary code execution\", \"suggestion\": \"Use JSON/joblib or restrict with __reduce_ex__ override\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async def fetch(url):\n    response = requests.get(url)\n    return response.json()", "output": "{\"severity\": \"CRITICAL\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Blocking Event Loop\", \"message\": \"Synchronous I/O in async corrupts event loop performance\", \"suggestion\": \"Use aiohttp: async with session.get(url) as resp\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def add_item(item, items=[]):\n    items.append(item)\n    return items", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Mutable Default\", \"message\": \"Mutable default arguments share state across calls\", \"suggestion\": \"Use None: def func(items=None): items = items or []\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import  subprocess\nsubprocess.call(f\"echo {user_input}\", shell=True)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Command Injection\", \"message\": \"User input in shell command enables arbitrary execution\", \"suggestion\": \"Use list args: subprocess.run([\\\"cmd\\\", arg])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "API_KEY = \"sk-1234567890abcdef\"\nheaders = {\"Authorization\": f\"Bearer {API_KEY}\"}", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Hardcoded Credentials\", \"message\": \"API keys in source code leak in VCS\", \"suggestion\": \"Use os.getenv(\\\"API_KEY\\\") or secret managers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "# module_a.py\nfrom module_b import ClassB\n\nclass ClassA:\n    def use(self): ClassB()", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Circular Import\", \"message\": \"Mutual imports create coupling and runtime errors\", \"suggestion\": \"Refactor to shared module or use lazy imports\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "try:\n    risky_operation()\nexcept:\n    pass", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Bare Except\", \"message\": \"Catching all exceptions hides errors and hampers debugging\", \"suggestion\": \"Catch specific exceptions: except ValueError\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def process(data):\n    result = transform(data)\n    return result", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Missing Type Hints\", \"message\": \"Dynamic typing without hints reduces code clarity\", \"suggestion\": \"Add type hints: def func(x: int) -> str\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "cursor.execute(f\"SELECT * FROM users WHERE name = '{name}'\")", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"SQL Injection\", \"message\": \"String formatting in SQL queries enables injection\", \"suggestion\": \"Use parameterized queries: cursor.execute(sql, (val,))\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "counter = 0\ndef increment():\n    global counter\n    counter += 1", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Global State\", \"message\": \"Global variables create hidden dependencies\", \"suggestion\": \"Use dependency injection or class attributes\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "useEffect(() => {\n    fetchUser(userId);\n}, []);", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Missing Dependencies\", \"message\": \"useEffect without proper deps causes stale closures\", \"suggestion\": \"Add all dependencies: useEffect(() => {...}, [userId])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<div dangerouslySetInnerHTML={{ __html: userContent }} />", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"XSS Vulnerability\", \"message\": \"Unsanitized HTML rendering enables script injection\", \"suggestion\": \"Use DOMPurify.sanitize() before rendering\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "getData(result => {\n    process(result, processed => {\n        save(processed, response => callback(response));\n    });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Callback Hell\", \"message\": \"Nested callbacks create unmaintainable pyramid of doom\", \"suggestion\": \"Use async/await: const r = await getData(); await process(r)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const user = await User.findOne({ username: req.body.username });", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"NoSQL Injection\", \"message\": \"Unsanitized MongoDB queries enable data extraction\", \"suggestion\": \"Validate input types and use schema validation\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const config = {};\nObject.assign(config, JSON.parse(userInput));", "output": "{\"severity\": \"WARNING\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Prototype Pollution\", \"message\": \"Object.assign with untrusted input pollutes prototypes\", \"suggestion\": \"Validate keys or use Object.create(null)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "function process(data: any): any {\n    return data.map((x: any) => x.value);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Any Type Abuse\", \"message\": \"Type assertions to any eliminate type safety\", \"suggestion\": \"Define proper interfaces for type safety\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<Component user={user} theme={theme} settings={settings} />", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Prop Drilling\", \"message\": \"Passing props through multiple layers creates coupling\", \"suggestion\": \"Use React Context or state management library\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async function save() {}\nsave(); // Fire and forget", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Ignoring Promises\", \"message\": \"Async functions called without await or .catch()\", \"suggestion\": \"Add await or .catch() for error handling\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const result = eval(userInput);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Eval Injection\", \"message\": \"Using eval() with user input enables code execution\", \"suggestion\": \"Use JSON.parse() or safe expression evaluators\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const addItem = () => {\n    items.push(newItem);\n    setItems(items);\n};", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"State Mutation\", \"message\": \"Directly mutating state breaks React rendering\", \"suggestion\": \"Use immutable updates: setState([...items, newItem])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String query = \"SELECT * FROM users WHERE id = \" + userId;\nStatement stmt = conn.createStatement();\nResultSet rs = stmt.executeQuery(query);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"SQL Injection\", \"message\": \"Direct string concatenation in SQL creates injection vulnerability\", \"suggestion\": \"Use PreparedStatement with parameterized queries\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Service\npublic class OrderService {\n    void validate() {}\n    void charge() {}\n    void email() {}\n    void log() {}\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"God Class\", \"message\": \"Single class handling multiple responsibilities violates SRP\", \"suggestion\": \"Split into OrderValidator, PaymentProcessor, EmailService\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "private static final String JWT_SECRET = \"my-secret-key-123\";", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Hardcoded Secret\", \"message\": \"JWT secret in source code enables token forgery\", \"suggestion\": \"Load from environment: System.getenv(\\\"JWT_SECRET\\\")\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@GetMapping(\"/users/{id}\")\npublic User getUser(@PathVariable Long id) {\n    return userRepo.findById(id).get();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Entity Exposure\", \"message\": \"JPA entities exposed to API layer leak database schema\", \"suggestion\": \"Create DTOs for API contracts, map in service layer\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String path = \"/uploads/\" + request.getParameter(\"filename\");\nFile file = new File(path);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Path Traversal\", \"message\": \"Unsanitized filename allows directory traversal attacks\", \"suggestion\": \"Use Paths.get(filename).getFileName() or UUID.randomUUID()\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public void transfer(Account from, Account to, BigDecimal amount) {\n    from.debit(amount);\n    to.credit(amount);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Missing Transaction\", \"message\": \"Multi-step database operations without @Transactional risk partial updates\", \"suggestion\": \"Add @Transactional to ensure atomicity\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public class UserService {\n    private EmailService emailService = new EmailService();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Tight Coupling\", \"message\": \"Direct instantiation creates hard dependencies\", \"suggestion\": \"Use dependency injection via constructor\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nDocument doc = factory.newDocumentBuilder().parse(inputStream);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"XXE Vulnerability\", \"message\": \"XML parser without disabling external entities\", \"suggestion\": \"factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "InputStream is = new FileInputStream(file);\nString content = new String(is.readAllBytes());\nis.close();", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Resource Leak\", \"message\": \"InputStream not closed on exception\", \"suggestion\": \"Use try-with-resources\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Async\npublic CompletableFuture<User> getUser(Long id) {\n    return CompletableFuture.completedFuture(restTemplate.getForObject(url, User.class));\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Synchronous in Async\", \"message\": \"Blocking call in async method defeats reactive programming\", \"suggestion\": \"Use WebClient or reactive database drivers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import pickle\nwith open(file_path, \"rb\") as f:\n    data = pickle.load(f)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Pickle Vulnerability\", \"message\": \"Deserializing untrusted pickle enables arbitrary code execution\", \"suggestion\": \"Use JSON/joblib or restrict with __reduce_ex__ override\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async def fetch(url):\n    response = requests.get(url)\n    return response.json()", "output": "{\"severity\": \"CRITICAL\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Blocking Event Loop\", \"message\": \"Synchronous I/O in async corrupts event loop performance\", \"suggestion\": \"Use aiohttp: async with session.get(url) as resp\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def add_item(item, items=[]):\n    items.append(item)\n    return items", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Mutable Default\", \"message\": \"Mutable default arguments share state across calls\", \"suggestion\": \"Use None: def func(items=None): items = items or []\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import  subprocess\nsubprocess.call(f\"echo {user_input}\", shell=True)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Command Injection\", \"message\": \"User input in shell command enables arbitrary execution\", \"suggestion\": \"Use list args: subprocess.run([\\\"cmd\\\", arg])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "API_KEY = \"sk-1234567890abcdef\"\nheaders = {\"Authorization\": f\"Bearer {API_KEY}\"}", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Hardcoded Credentials\", \"message\": \"API keys in source code leak in VCS\", \"suggestion\": \"Use os.getenv(\\\"API_KEY\\\") or secret managers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "# module_a.py\nfrom module_b import ClassB\n\nclass ClassA:\n    def use(self): ClassB()", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Circular Import\", \"message\": \"Mutual imports create coupling and runtime errors\", \"suggestion\": \"Refactor to shared module or use lazy imports\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "try:\n    risky_operation()\nexcept:\n    pass", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Bare Except\", \"message\": \"Catching all exceptions hides errors and hampers debugging\", \"suggestion\": \"Catch specific exceptions: except ValueError\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def process(data):\n    result = transform(data)\n    return result", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Missing Type Hints\", \"message\": \"Dynamic typing without hints reduces code clarity\", \"suggestion\": \"Add type hints: def func(x: int) -> str\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "cursor.execute(f\"SELECT * FROM users WHERE name = '{name}'\")", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"SQL Injection\", \"message\": \"String formatting in SQL queries enables injection\", \"suggestion\": \"Use parameterized queries: cursor.execute(sql, (val,))\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "counter = 0\ndef increment():\n    global counter\n    counter += 1", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Global State\", \"message\": \"Global variables create hidden dependencies\", \"suggestion\": \"Use dependency injection or class attributes\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "useEffect(() => {\n    fetchUser(userId);\n}, []);", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Missing Dependencies\", \"message\": \"useEffect without proper deps causes stale closures\", \"suggestion\": \"Add all dependencies: useEffect(() => {...}, [userId])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<div dangerouslySetInnerHTML={{ __html: userContent }} />", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"XSS Vulnerability\", \"message\": \"Unsanitized HTML rendering enables script injection\", \"suggestion\": \"Use DOMPurify.sanitize() before rendering\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "getData(result => {\n    process(result, processed => {\n        save(processed, response => callback(response));\n    });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Callback Hell\", \"message\": \"Nested callbacks create unmaintainable pyramid of doom\", \"suggestion\": \"Use async/await: const r = await getData(); await process(r)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const user = await User.findOne({ username: req.body.username });", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"NoSQL Injection\", \"message\": \"Unsanitized MongoDB queries enable data extraction\", \"suggestion\": \"Validate input types and use schema validation\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const config = {};\nObject.assign(config, JSON.parse(userInput));", "output": "{\"severity\": \"WARNING\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Prototype Pollution\", \"message\": \"Object.assign with untrusted input pollutes prototypes\", \"suggestion\": \"Validate keys or use Object.create(null)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "function process(data: any): any {\n    return data.map((x: any) => x.value);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Any Type Abuse\", \"message\": \"Type assertions to any eliminate type safety\", \"suggestion\": \"Define proper interfaces for type safety\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<Component user={user} theme={theme} settings={settings} />", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Prop Drilling\", \"message\": \"Passing props through multiple layers creates coupling\", \"suggestion\": \"Use React Context or state management library\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async function save() {}\nsave(); // Fire and forget", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Ignoring Promises\", \"message\": \"Async functions called without await or .catch()\", \"suggestion\": \"Add await or .catch() for error handling\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const result = eval(userInput);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Eval Injection\", \"message\": \"Using eval() with user input enables code execution\", \"suggestion\": \"Use JSON.parse() or safe expression evaluators\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const addItem = () => {\n    items.push(newItem);\n    setItems(items);\n};", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"State Mutation\", \"message\": \"Directly mutating state breaks React rendering\", \"suggestion\": \"Use immutable updates: setState([...items, newItem])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String query = \"SELECT * FROM users WHERE id = \" + userId;\nStatement stmt = conn.createStatement();\nResultSet rs = stmt.executeQuery(query);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"SQL Injection\", \"message\": \"Direct string concatenation in SQL creates injection vulnerability\", \"suggestion\": \"Use PreparedStatement with parameterized queries\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Service\npublic class OrderService {\n    void validate() {}\n    void charge() {}\n    void email() {}\n    void log() {}\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"God Class\", \"message\": \"Single class handling multiple responsibilities violates SRP\", \"suggestion\": \"Split into OrderValidator, PaymentProcessor, EmailService\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "private static final String JWT_SECRET = \"my-secret-key-123\";", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Hardcoded Secret\", \"message\": \"JWT secret in source code enables token forgery\", \"suggestion\": \"Load from environment: System.getenv(\\\"JWT_SECRET\\\")\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@GetMapping(\"/users/{id}\")\npublic User getUser(@PathVariable Long id) {\n    return userRepo.findById(id).get();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Entity Exposure\", \"message\": \"JPA entities exposed to API layer leak database schema\", \"suggestion\": \"Create DTOs for API contracts, map in service layer\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String path = \"/uploads/\" + request.getParameter(\"filename\");\nFile file = new File(path);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Path Traversal\", \"message\": \"Unsanitized filename allows directory traversal attacks\", \"suggestion\": \"Use Paths.get(filename).getFileName() or UUID.randomUUID()\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public void transfer(Account from, Account to, BigDecimal amount) {\n    from.debit(amount);\n    to.credit(amount);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Missing Transaction\", \"message\": \"Multi-step database operations without @Transactional risk partial updates\", \"suggestion\": \"Add @Transactional to ensure atomicity\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public class UserService {\n    private EmailService emailService = new EmailService();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Tight Coupling\", \"message\": \"Direct instantiation creates hard dependencies\", \"suggestion\": \"Use dependency injection via constructor\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nDocument doc = factory.newDocumentBuilder().parse(inputStream);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"XXE Vulnerability\", \"message\": \"XML parser without disabling external entities\", \"suggestion\": \"factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "InputStream is = new FileInputStream(file);\nString content = new String(is.readAllBytes());\nis.close();", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Resource Leak\", \"message\": \"InputStream not closed on exception\", \"suggestion\": \"Use try-with-resources\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Async\npublic CompletableFuture<User> getUser(Long id) {\n    return CompletableFuture.completedFuture(restTemplate.getForObject(url, User.class));\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Synchronous in Async\", \"message\": \"Blocking call in async method defeats reactive programming\", \"suggestion\": \"Use WebClient or reactive database drivers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import pickle\nwith open(file_path, \"rb\") as f:\n    data = pickle.load(f)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Pickle Vulnerability\", \"message\": \"Deserializing untrusted pickle enables arbitrary code execution\", \"suggestion\": \"Use JSON/joblib or restrict with __reduce_ex__ override\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async def fetch(url):\n    response = requests.get(url)\n    return response.json()", "output": "{\"severity\": \"CRITICAL\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Blocking Event Loop\", \"message\": \"Synchronous I/O in async corrupts event loop performance\", \"suggestion\": \"Use aiohttp: async with session.get(url) as resp\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def add_item(item, items=[]):\n    items.append(item)\n    return items", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Mutable Default\", \"message\": \"Mutable default arguments share state across calls\", \"suggestion\": \"Use None: def func(items=None): items = items or []\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import  subprocess\nsubprocess.call(f\"echo {user_input}\", shell=True)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Command Injection\", \"message\": \"User input in shell command enables arbitrary execution\", \"suggestion\": \"Use list args: subprocess.run([\\\"cmd\\\", arg])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "API_KEY = \"sk-1234567890abcdef\"\nheaders = {\"Authorization\": f\"Bearer {API_KEY}\"}", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Hardcoded Credentials\", \"message\": \"API keys in source code leak in VCS\", \"suggestion\": \"Use os.getenv(\\\"API_KEY\\\") or secret managers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "# module_a.py\nfrom module_b import ClassB\n\nclass ClassA:\n    def use(self): ClassB()", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Circular Import\", \"message\": \"Mutual imports create coupling and runtime errors\", \"suggestion\": \"Refactor to shared module or use lazy imports\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "try:\n    risky_operation()\nexcept:\n    pass", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Bare Except\", \"message\": \"Catching all exceptions hides errors and hampers debugging\", \"suggestion\": \"Catch specific exceptions: except ValueError\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def process(data):\n    result = transform(data)\n    return result", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Missing Type Hints\", \"message\": \"Dynamic typing without hints reduces code clarity\", \"suggestion\": \"Add type hints: def func(x: int) -> str\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "cursor.execute(f\"SELECT * FROM users WHERE name = '{name}'\")", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"SQL Injection\", \"message\": \"String formatting in SQL queries enables injection\", \"suggestion\": \"Use parameterized queries: cursor.execute(sql, (val,))\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "counter = 0\ndef increment():\n    global counter\n    counter += 1", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Global State\", \"message\": \"Global variables create hidden dependencies\", \"suggestion\": \"Use dependency injection or class attributes\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "useEffect(() => {\n    fetchUser(userId);\n}, []);", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Missing Dependencies\", \"message\": \"useEffect without proper deps causes stale closures\", \"suggestion\": \"Add all dependencies: useEffect(() => {...}, [userId])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<div dangerouslySetInnerHTML={{ __html: userContent }} />", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"XSS Vulnerability\", \"message\": \"Unsanitized HTML rendering enables script injection\", \"suggestion\": \"Use DOMPurify.sanitize() before rendering\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "getData(result => {\n    process(result, processed => {\n        save(processed, response => callback(response));\n    });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Callback Hell\", \"message\": \"Nested callbacks create unmaintainable pyramid of doom\", \"suggestion\": \"Use async/await: const r = await getData(); await process(r)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const user = await User.findOne({ username: req.body.username });", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"NoSQL Injection\", \"message\": \"Unsanitized MongoDB queries enable data extraction\", \"suggestion\": \"Validate input types and use schema validation\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const config = {};\nObject.assign(config, JSON.parse(userInput));", "output": "{\"severity\": \"WARNING\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Prototype Pollution\", \"message\": \"Object.assign with untrusted input pollutes prototypes\", \"suggestion\": \"Validate keys or use Object.create(null)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "function process(data: any): any {\n    return data.map((x: any) => x.value);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Any Type Abuse\", \"message\": \"Type assertions to any eliminate type safety\", \"suggestion\": \"Define proper interfaces for type safety\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<Component user={user} theme={theme} settings={settings} />", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Prop Drilling\", \"message\": \"Passing props through multiple layers creates coupling\", \"suggestion\": \"Use React Context or state management library\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async function save() {}\nsave(); // Fire and forget", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Ignoring Promises\", \"message\": \"Async functions called without await or .catch()\", \"suggestion\": \"Add await or .catch() for error handling\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const result = eval(userInput);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Eval Injection\", \"message\": \"Using eval() with user input enables code execution\", \"suggestion\": \"Use JSON.parse() or safe expression evaluators\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const addItem = () => {\n    items.push(newItem);\n    setItems(items);\n};", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"State Mutation\", \"message\": \"Directly mutating state breaks React rendering\", \"suggestion\": \"Use immutable updates: setState([...items, newItem])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String query = \"SELECT * FROM users WHERE id = \" + userId;\nStatement stmt = conn.createStatement();\nResultSet rs = stmt.executeQuery(query);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"SQL Injection\", \"message\": \"Direct string concatenation in SQL creates injection vulnerability\", \"suggestion\": \"Use PreparedStatement with parameterized queries\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Service\npublic class OrderService {\n    void validate() {}\n    void charge() {}\n    void email() {}\n    void log() {}\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"God Class\", \"message\": \"Single class handling multiple responsibilities violates SRP\", \"suggestion\": \"Split into OrderValidator, PaymentProcessor, EmailService\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "private static final String JWT_SECRET = \"my-secret-key-123\";", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Hardcoded Secret\", \"message\": \"JWT secret in source code enables token forgery\", \"suggestion\": \"Load from environment: System.getenv(\\\"JWT_SECRET\\\")\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@GetMapping(\"/users/{id}\")\npublic User getUser(@PathVariable Long id) {\n    return userRepo.findById(id).get();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Entity Exposure\", \"message\": \"JPA entities exposed to API layer leak database schema\", \"suggestion\": \"Create DTOs for API contracts, map in service layer\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String path = \"/uploads/\" + request.getParameter(\"filename\");\nFile file = new File(path);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Path Traversal\", \"message\": \"Unsanitized filename allows directory traversal attacks\", \"suggestion\": \"Use Paths.get(filename).getFileName() or UUID.randomUUID()\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public void transfer(Account from, Account to, BigDecimal amount) {\n    from.debit(amount);\n    to.credit(amount);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Missing Transaction\", \"message\": \"Multi-step database operations without @Transactional risk partial updates\", \"suggestion\": \"Add @Transactional to ensure atomicity\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public class UserService {\n    private EmailService emailService = new EmailService();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Tight Coupling\", \"message\": \"Direct instantiation creates hard dependencies\", \"suggestion\": \"Use dependency injection via constructor\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nDocument doc = factory.newDocumentBuilder().parse(inputStream);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"XXE Vulnerability\", \"message\": \"XML parser without disabling external entities\", \"suggestion\": \"factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "InputStream is = new FileInputStream(file);\nString content = new String(is.readAllBytes());\nis.close();", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Resource Leak\", \"message\": \"InputStream not closed on exception\", \"suggestion\": \"Use try-with-resources\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Async\npublic CompletableFuture<User> getUser(Long id) {\n    return CompletableFuture.completedFuture(restTemplate.getForObject(url, User.class));\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Synchronous in Async\", \"message\": \"Blocking call in async method defeats reactive programming\", \"suggestion\": \"Use WebClient or reactive database drivers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import pickle\nwith open(file_path, \"rb\") as f:\n    data = pickle.load(f)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Pickle Vulnerability\", \"message\": \"Deserializing untrusted pickle enables arbitrary code execution\", \"suggestion\": \"Use JSON/joblib or restrict with __reduce_ex__ override\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async def fetch(url):\n    response = requests.get(url)\n    return response.json()", "output": "{\"severity\": \"CRITICAL\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Blocking Event Loop\", \"message\": \"Synchronous I/O in async corrupts event loop performance\", \"suggestion\": \"Use aiohttp: async with session.get(url) as resp\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def add_item(item, items=[]):\n    items.append(item)\n    return items", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Mutable Default\", \"message\": \"Mutable default arguments share state across calls\", \"suggestion\": \"Use None: def func(items=None): items = items or []\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import  subprocess\nsubprocess.call(f\"echo {user_input}\", shell=True)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Command Injection\", \"message\": \"User input in shell command enables arbitrary execution\", \"suggestion\": \"Use list args: subprocess.run([\\\"cmd\\\", arg])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "API_KEY = \"sk-1234567890abcdef\"\nheaders = {\"Authorization\": f\"Bearer {API_KEY}\"}", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Hardcoded Credentials\", \"message\": \"API keys in source code leak in VCS\", \"suggestion\": \"Use os.getenv(\\\"API_KEY\\\") or secret managers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "# module_a.py\nfrom module_b import ClassB\n\nclass ClassA:\n    def use(self): ClassB()", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Circular Import\", \"message\": \"Mutual imports create coupling and runtime errors\", \"suggestion\": \"Refactor to shared module or use lazy imports\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "try:\n    risky_operation()\nexcept:\n    pass", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Bare Except\", \"message\": \"Catching all exceptions hides errors and hampers debugging\", \"suggestion\": \"Catch specific exceptions: except ValueError\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def process(data):\n    result = transform(data)\n    return result", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Missing Type Hints\", \"message\": \"Dynamic typing without hints reduces code clarity\", \"suggestion\": \"Add type hints: def func(x: int) -> str\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "cursor.execute(f\"SELECT * FROM users WHERE name = '{name}'\")", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"SQL Injection\", \"message\": \"String formatting in SQL queries enables injection\", \"suggestion\": \"Use parameterized queries: cursor.execute(sql, (val,))\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "counter = 0\ndef increment():\n    global counter\n    counter += 1", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Global State\", \"message\": \"Global variables create hidden dependencies\", \"suggestion\": \"Use dependency injection or class attributes\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "useEffect(() => {\n    fetchUser(userId);\n}, []);", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Missing Dependencies\", \"message\": \"useEffect without proper deps causes stale closures\", \"suggestion\": \"Add all dependencies: useEffect(() => {...}, [userId])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<div dangerouslySetInnerHTML={{ __html: userContent }} />", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"XSS Vulnerability\", \"message\": \"Unsanitized HTML rendering enables script injection\", \"suggestion\": \"Use DOMPurify.sanitize() before rendering\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "getData(result => {\n    process(result, processed => {\n        save(processed, response => callback(response));\n    });\n});", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Callback Hell\", \"message\": \"Nested callbacks create unmaintainable pyramid of doom\", \"suggestion\": \"Use async/await: const r = await getData(); await process(r)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const user = await User.findOne({ username: req.body.username });", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"NoSQL Injection\", \"message\": \"Unsanitized MongoDB queries enable data extraction\", \"suggestion\": \"Validate input types and use schema validation\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const config = {};\nObject.assign(config, JSON.parse(userInput));", "output": "{\"severity\": \"WARNING\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Prototype Pollution\", \"message\": \"Object.assign with untrusted input pollutes prototypes\", \"suggestion\": \"Validate keys or use Object.create(null)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "function process(data: any): any {\n    return data.map((x: any) => x.value);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Any Type Abuse\", \"message\": \"Type assertions to any eliminate type safety\", \"suggestion\": \"Define proper interfaces for type safety\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "<Component user={user} theme={theme} settings={settings} />", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"Prop Drilling\", \"message\": \"Passing props through multiple layers creates coupling\", \"suggestion\": \"Use React Context or state management library\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async function save() {}\nsave(); // Fire and forget", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"TypeScript\", \"title\": \"Ignoring Promises\", \"message\": \"Async functions called without await or .catch()\", \"suggestion\": \"Add await or .catch() for error handling\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const result = eval(userInput);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"TypeScript\", \"title\": \"Eval Injection\", \"message\": \"Using eval() with user input enables code execution\", \"suggestion\": \"Use JSON.parse() or safe expression evaluators\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "const addItem = () => {\n    items.push(newItem);\n    setItems(items);\n};", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"TypeScript\", \"title\": \"State Mutation\", \"message\": \"Directly mutating state breaks React rendering\", \"suggestion\": \"Use immutable updates: setState([...items, newItem])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String query = \"SELECT * FROM users WHERE id = \" + userId;\nStatement stmt = conn.createStatement();\nResultSet rs = stmt.executeQuery(query);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"SQL Injection\", \"message\": \"Direct string concatenation in SQL creates injection vulnerability\", \"suggestion\": \"Use PreparedStatement with parameterized queries\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Service\npublic class OrderService {\n    void validate() {}\n    void charge() {}\n    void email() {}\n    void log() {}\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"God Class\", \"message\": \"Single class handling multiple responsibilities violates SRP\", \"suggestion\": \"Split into OrderValidator, PaymentProcessor, EmailService\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "private static final String JWT_SECRET = \"my-secret-key-123\";", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Hardcoded Secret\", \"message\": \"JWT secret in source code enables token forgery\", \"suggestion\": \"Load from environment: System.getenv(\\\"JWT_SECRET\\\")\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@GetMapping(\"/users/{id}\")\npublic User getUser(@PathVariable Long id) {\n    return userRepo.findById(id).get();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Entity Exposure\", \"message\": \"JPA entities exposed to API layer leak database schema\", \"suggestion\": \"Create DTOs for API contracts, map in service layer\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "String path = \"/uploads/\" + request.getParameter(\"filename\");\nFile file = new File(path);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"Path Traversal\", \"message\": \"Unsanitized filename allows directory traversal attacks\", \"suggestion\": \"Use Paths.get(filename).getFileName() or UUID.randomUUID()\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public void transfer(Account from, Account to, BigDecimal amount) {\n    from.debit(amount);\n    to.credit(amount);\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Missing Transaction\", \"message\": \"Multi-step database operations without @Transactional risk partial updates\", \"suggestion\": \"Add @Transactional to ensure atomicity\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "public class UserService {\n    private EmailService emailService = new EmailService();\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Tight Coupling\", \"message\": \"Direct instantiation creates hard dependencies\", \"suggestion\": \"Use dependency injection via constructor\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\nDocument doc = factory.newDocumentBuilder().parse(inputStream);", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Java\", \"title\": \"XXE Vulnerability\", \"message\": \"XML parser without disabling external entities\", \"suggestion\": \"factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "InputStream is = new FileInputStream(file);\nString content = new String(is.readAllBytes());\nis.close();", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Java\", \"title\": \"Resource Leak\", \"message\": \"InputStream not closed on exception\", \"suggestion\": \"Use try-with-resources\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "@Async\npublic CompletableFuture<User> getUser(Long id) {\n    return CompletableFuture.completedFuture(restTemplate.getForObject(url, User.class));\n}", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Java\", \"title\": \"Synchronous in Async\", \"message\": \"Blocking call in async method defeats reactive programming\", \"suggestion\": \"Use WebClient or reactive database drivers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import pickle\nwith open(file_path, \"rb\") as f:\n    data = pickle.load(f)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Pickle Vulnerability\", \"message\": \"Deserializing untrusted pickle enables arbitrary code execution\", \"suggestion\": \"Use JSON/joblib or restrict with __reduce_ex__ override\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "async def fetch(url):\n    response = requests.get(url)\n    return response.json()", "output": "{\"severity\": \"CRITICAL\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Blocking Event Loop\", \"message\": \"Synchronous I/O in async corrupts event loop performance\", \"suggestion\": \"Use aiohttp: async with session.get(url) as resp\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def add_item(item, items=[]):\n    items.append(item)\n    return items", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Mutable Default\", \"message\": \"Mutable default arguments share state across calls\", \"suggestion\": \"Use None: def func(items=None): items = items or []\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "import  subprocess\nsubprocess.call(f\"echo {user_input}\", shell=True)", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Command Injection\", \"message\": \"User input in shell command enables arbitrary execution\", \"suggestion\": \"Use list args: subprocess.run([\\\"cmd\\\", arg])\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "API_KEY = \"sk-1234567890abcdef\"\nheaders = {\"Authorization\": f\"Bearer {API_KEY}\"}", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"Hardcoded Credentials\", \"message\": \"API keys in source code leak in VCS\", \"suggestion\": \"Use os.getenv(\\\"API_KEY\\\") or secret managers\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "# module_a.py\nfrom module_b import ClassB\n\nclass ClassA:\n    def use(self): ClassB()", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Circular Import\", \"message\": \"Mutual imports create coupling and runtime errors\", \"suggestion\": \"Refactor to shared module or use lazy imports\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "try:\n    risky_operation()\nexcept:\n    pass", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Bare Except\", \"message\": \"Catching all exceptions hides errors and hampers debugging\", \"suggestion\": \"Catch specific exceptions: except ValueError\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "def process(data):\n    result = transform(data)\n    return result", "output": "{\"severity\": \"WARNING\", \"category\": \"ARCHITECTURE\", \"language\": \"Python\", \"title\": \"Missing Type Hints\", \"message\": \"Dynamic typing without hints reduces code clarity\", \"suggestion\": \"Add type hints: def func(x: int) -> str\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "cursor.execute(f\"SELECT * FROM users WHERE name = '{name}'\")", "output": "{\"severity\": \"CRITICAL\", \"category\": \"SECURITY\", \"language\": \"Python\", \"title\": \"SQL Injection\", \"message\": \"String formatting in SQL queries enables injection\", \"suggestion\": \"Use parameterized queries: cursor.execute(sql, (val,))\"}"}
{"instruction": "Analyze the following code for architectural flaws, security vulnerabilities, and design anti-patterns. Return the result in strict JSON format.", "input": "counter = 0\ndef increment():\n    global counter\n    counter += 1", "output": "{\"severity\": \"WARNING\", \"category\": \"BEST_PRACTICE\", \"language\": \"Python\", \"title\": \"Global State\", \"message\": \"Global variables create hidden dependencies\", \"suggestion\": \"Use dependency injection or class attributes\"}"}
